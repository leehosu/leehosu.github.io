<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.2ff171c7e29f693bc948.css" id="gatsby-global-css">.hamburger{width:22px;height:17px;position:relative;-webkit-transition:.5s ease-in-out;transition:.5s ease-in-out;cursor:pointer}.hamburger,.hamburger span{-webkit-transform:rotate(0deg);transform:rotate(0deg)}.hamburger span{display:block;position:absolute;height:3px;width:100%;background:#222;border-radius:4px;opacity:1;left:0;-webkit-transition:.25s ease-in-out;transition:.25s ease-in-out}.hamburger span:first-child{top:0}.hamburger span:nth-child(2),.hamburger span:nth-child(3){top:7px}.hamburger span:nth-child(4){top:14px}.hamburger.open span:first-child{top:7px;width:0;left:50%}.hamburger.open span:nth-child(2){-webkit-transform:rotate(45deg);transform:rotate(45deg)}.hamburger.open span:nth-child(3){-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.hamburger.open span:nth-child(4){top:7px;width:0;left:50%}.navigation-container{-webkit-box-shadow:inset 0 -1px 0 0 #fff,0 1px 5px rgba(0,0,0,.1);box-shadow:inset 0 -1px 0 0 #fff,0 1px 5px rgba(0,0,0,.1)}.navigation-container .navigation-main{height:64px}.navigation-container .navigation-main .brand a{color:#222}.navigation-container .navigation-main .brand .image{width:auto;height:32px}.navigation-container .navigation-main .nav-links{display:none}.navigation-container .navigation-main .nav-links .item{color:rgba(0,0,0,.6);font-weight:500}.navigation-container .navigation-main .nav-links .item.active,.navigation-container .navigation-main .nav-links .item:hover{color:#222}.navigation-container .navigation-main .navbars{display:block;color:#222;margin-right:-1.5rem}.navigation-container .navigation-dropdown .nav-links .item{display:block;color:rgba(0,0,0,.6);font-weight:500}.navigation-container .navigation-dropdown .nav-links .item.active,.navigation-container .navigation-dropdown .nav-links .item:hover{color:#222}@media(min-width:800px){.navigation-container .navigation-main .nav-links{display:unset}.navigation-container .navigation-dropdown,.navigation-container .navigation-main .navbars{display:none}}.scroll-to-top{right:1.5rem;bottom:1.5rem;z-index:1000}
/*! 
 * Shiba CSS | MIT License | v1.0.1 | Author: Lam Pham
 * Source: https://github.com/completejavascript/shiba
 * Documentation: https://about.phamvanlam.com/shiba
 *//*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{-webkit-box-sizing:content-box;box-sizing:content-box;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}html{-webkit-box-sizing:border-box;box-sizing:border-box;font-size:62.5%}*,:after,:before{-webkit-box-sizing:inherit;box-sizing:inherit}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url],select,textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none}body{color:#222;padding:0;background-color:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font:normal normal normal 1.7rem/1.7 -apple-system,BlinkMacSystemFont,Nunito Sans,Helvetica,Arial,sans-serif}h1,h2,h3,h4,h5,h6{line-height:1.2;margin:0 0 2rem}h1{font-size:3.2rem;margin-top:50px}h2{font-size:2.8rem}h3{font-size:2.4rem}h4{font-size:2.2rem}h5{font-size:2rem}h6{font-size:1.8rem}@media (min-width:600px){h1{font-size:3.6rem}h2{font-size:3.2rem}h3{font-size:2.8rem}h4{font-size:2.6rem}h5{font-size:2.4rem}h6{font-size:2.2rem}}p{margin:0 0 2rem}mark{padding:0 .32rem;background-color:#ffeb3b}a{color:#0ca678;text-decoration:none;word-break:break-all}a:active,a:focus,a:hover{color:#000;font-weight:700}:not(pre)>code{font-size:85%;margin:0;padding:.2rem .4rem;white-space:nowrap}:not(pre)>code,pre{background-color:rgba(27,31,35,.08);border-radius:.3rem}pre{padding:1.2rem 1.6rem;margin:0 0 2rem;-moz-tab-size:2;-o-tab-size:2;tab-size:2;overflow:auto}pre code{white-space:pre}kbd{display:inline-block;vertical-align:middle;background-color:#fafbfc;color:#444d56;border:.1rem solid #cdcdcd;border-radius:.3rem;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.12);box-shadow:inset 0 -1px 0 rgba(0,0,0,.12);font-size:85%;line-height:1.2rem;padding:.5rem .8rem}blockquote{margin:0 0 2rem;padding:0 1.5rem;border-left:1rem solid #cdcdcd;font-size:1.8rem}blockquote cite{display:block;text-align:right;margin-top:2rem}hr{height:0;border:0;border-top:.1rem solid #cdcdcd}hr,ol,ul{margin:0 0 2rem}ol li ol,ol li p,ol li ul,ul li ol,ul li p,ul li ul{margin-bottom:0}table{margin:0 0 2rem;width:100%;max-width:100%;border-spacing:0}td,th{padding:1.2rem 1.5rem;text-align:left;border-bottom:.1rem solid #cdcdcd}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}button,input[type=button],input[type=reset],input[type=submit]{cursor:pointer;display:-ms-inline-flexbox;display:inline-flex;display:-webkit-inline-flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;text-decoration:none;white-space:nowrap;height:3.8rem;line-height:3.8rem;padding:0 1.5rem;color:#222;font-size:1.7rem;background-color:transparent;border:.1rem solid #bbb;border-radius:.3rem;outline:0;margin:0 0 .8rem;text-transform:none}button:focus,button:hover,input[type=button]:focus,input[type=button]:hover,input[type=reset]:focus,input[type=reset]:hover,input[type=submit]:focus,input[type=submit]:hover{text-decoration:none;color:#2196f3;border-color:#2196f3}form{margin:0 0 2rem}input[type=email],input[type=number],input[type=password],input[type=search],input[type=tel],input[type=text],input[type=url]{height:3.8rem;margin:0 0 2rem;background-color:transparent;border:.1rem solid #cdcdcd;border-radius:.3rem;-webkit-box-shadow:none;box-shadow:none;width:100%;max-width:100%;padding:0 1.5rem}input[type=email]:hover,input[type=number]:hover,input[type=password]:hover,input[type=search]:hover,input[type=tel]:hover,input[type=text]:hover,input[type=url]:hover{border-color:#aeaeae;outline:0}input[type=email]:focus,input[type=number]:focus,input[type=password]:focus,input[type=search]:focus,input[type=tel]:focus,input[type=text]:focus,input[type=url]:focus{border-color:#2196f3;outline:0}input[type=checkbox],input[type=radio]{display:inline}select{height:3.8rem;margin:0 0 2rem;background-color:transparent;border:.1rem solid #cdcdcd;border-radius:.3rem;-webkit-box-shadow:none;box-shadow:none;width:100%;max-width:100%;padding:0 1.5rem;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAJCAYAAAA/33wPAAAAvklEQVQoFY2QMQqEMBBFv7ERa/EMXkGw11K8QbDXzuN4BHv7QO6ifUgj7v4UAdlVM8Uwf+b9YZJISnlqrfEUZVlinucnBGKaJgghbiHOyLyFKIoCbdvecpyReYvo/Ma2bajrGtbaC58kCdZ1RZ7nl/4/4d5EsO/7nzl7IUtodBexMMagaRrs+06JLMvcNWmaOv2W/C/TMAyD58dxROgSmvxFFMdxoOs6lliWBXEcuzokXRbRoJRyvqqqQvye+QDMDz1D6yuj9wAAAABJRU5ErkJggg==) 100% no-repeat}select:hover{border-color:#aeaeae;outline:0}select:focus{border-color:#2196f3;outline:0}textarea{height:3.8rem;margin:0 0 2rem;background-color:transparent;border:.1rem solid #cdcdcd;border-radius:.3rem;-webkit-box-shadow:none;box-shadow:none;width:100%;max-width:100%;padding:1rem 1.5rem;min-height:10rem}textarea:hover{border-color:#aeaeae;outline:0}textarea:focus{border-color:#2196f3;outline:0}label{display:inline-block;margin:0 0 .5rem;font-weight:600}fieldset{border:.1rem solid #cdcdcd;border-radius:.3rem;padding:1.5rem;margin:2rem 0}legend{padding:0 .5rem;font-weight:600}.container,.container-full,.container-small{width:100%;max-width:100%;padding:0 1.5rem;margin-left:auto;margin-right:auto}.row:after{content:"";clear:both;display:table}[class*=col-]{float:left;padding:1.5rem 0}.col-xs-1{width:8.33333%}.col-xs-2{width:16.66667%}.col-xs-3{width:25%}.col-xs-4{width:33.33333%}.col-xs-5{width:41.66667%}.col-xs-6{width:50%}.col-xs-7{width:58.33333%}.col-xs-8{width:66.66667%}.col-xs-9{width:75%}.col-xs-10{width:83.33333%}.col-xs-11{width:91.66667%}.col-xs-12{width:100%}@media (min-width:600px){.col-sm-1{width:8.33333%}.col-sm-2{width:16.66667%}.col-sm-3{width:25%}.col-sm-4{width:33.33333%}.col-sm-5{width:41.66667%}.col-sm-6{width:50%}.col-sm-7{width:58.33333%}.col-sm-8{width:66.66667%}.col-sm-9{width:75%}.col-sm-10{width:83.33333%}.col-sm-11{width:91.66667%}.col-sm-12,.container{width:100%}.container-small{width:80%}}@media (min-width:800px){.col-md-1{width:8.33333%}.col-md-2{width:16.66667%}.col-md-3{width:25%}.col-md-4{width:33.33333%}.col-md-5{width:41.66667%}.col-md-6{width:50%}.col-md-7{width:58.33333%}.col-md-8{width:66.66667%}.col-md-9{width:75%}.col-md-10{width:83.33333%}.col-md-11{width:91.66667%}.col-md-12{width:100%}.container{width:800px}.container-small{width:640px}}@media (min-width:1000px){.col-lg-1{width:8.33333%}.col-lg-2{width:16.66667%}.col-lg-3{width:25%}.col-lg-4{width:33.33333%}.col-lg-5{width:41.66667%}.col-lg-6{width:50%}.col-lg-7{width:58.33333%}.col-lg-8{width:66.66667%}.col-lg-9{width:75%}.col-lg-10{width:83.33333%}.col-lg-11{width:91.66667%}.col-lg-12{width:100%}.container{width:1000px}.container-small{width:800px}}@media (min-width:1200px){.col-xl-1{width:8.33333%}.col-xl-2{width:16.66667%}.col-xl-3{width:25%}.col-xl-4{width:33.33333%}.col-xl-5{width:41.66667%}.col-xl-6{width:50%}.col-xl-7{width:58.33333%}.col-xl-8{width:66.66667%}.col-xl-9{width:75%}.col-xl-10{width:83.33333%}.col-xl-11{width:91.66667%}.col-xl-12{width:100%}.container{width:1200px}.container-small{width:960px}}.flex{display:-ms-flexbox!important;display:flex!important;display:-webkit-flex!important}.flex-column{flex-flow:column wrap!important;-ms-flex-flow:column wrap!important}.flex-row{flex-flow:row wrap!important;-ms-flex-flow:row wrap!important}.flex-spread{-ms-flex-positive:1!important;flex-grow:1!important}.flex-static{-ms-flex-negative:0!important;flex-shrink:0!important}.justify-content-center{-ms-flex-pack:center!important;justify-content:center!important}.justify-content-space-around{-ms-flex-pack:distribute!important;justify-content:space-around!important}.justify-content-space-between{-ms-flex-pack:justify!important;justify-content:space-between!important}.align-items-center{-ms-flex-align:center!important;align-items:center!important}.align-items-flex-start{-ms-flex-align:start!important;align-items:flex-start!important}.align-items-flex-end{-ms-flex-align:end!important;align-items:flex-end!important}.color-red{color:#f44336!important}.color-pink{color:#e91e63!important}.color-purple{color:#9c27b0!important}.color-deep-purple{color:#673ab7!important}.color-indigo{color:#3f51b5!important}.color-blue{color:#2196f3!important}.color-light-blue{color:#03a9f4!important}.color-cyan{color:#00bcd4!important}.color-teal{color:#009688!important}.color-green{color:#4caf50!important}.color-light-green{color:#8bc34a!important}.color-lime{color:#cddc39!important}.color-yellow{color:#ffeb3b!important}.color-amber{color:#ffc107!important}.color-orange{color:#ff9800!important}.color-deep-orange{color:#ff5722!important}.color-brown{color:#795548!important}.color-grey{color:#9e9e9e!important}.color-grey-half{color:hsla(0,0%,62%,.5)!important}.color-blue-grey{color:#607d8b!important}.color-dark-grey{color:#1e1e1e!important}.color-light-grey{color:#ececec!important}.color-black{color:#0a0a0a!important}.color-white{color:#fff!important}.background-color-red{background-color:#f44336!important}.background-color-pink{background-color:#e91e63!important}.background-color-purple{background-color:#9c27b0!important}.background-color-deep-purple{background-color:#673ab7!important}.background-color-indigo{background-color:#3f51b5!important}.background-color-blue{background-color:#2196f3!important}.background-color-light-blue{background-color:#03a9f4!important}.background-color-cyan{background-color:#00bcd4!important}.background-color-teal{background-color:#009688!important}.background-color-green{background-color:#4caf50!important}.background-color-light-green{background-color:#8bc34a!important}.background-color-lime{background-color:#cddc39!important}.background-color-yellow{background-color:#ffeb3b!important}.background-color-amber{background-color:#ffc107!important}.background-color-orange{background-color:#ff9800!important}.background-color-deep-orange{background-color:#ff5722!important}.background-color-brown{background-color:#795548!important}.background-color-grey{background-color:#9e9e9e!important}.background-color-grey-half{background-color:hsla(0,0%,62%,.5)!important}.background-color-blue-grey{background-color:#607d8b!important}.background-color-dark-grey{background-color:#1e1e1e!important}.background-color-light-grey{background-color:#ececec!important}.background-color-black{background-color:#0a0a0a!important}.background-color-white{background-color:#fff!important}.border-color-red{border-color:#f44336!important}.border-color-pink{border-color:#e91e63!important}.border-color-purple{border-color:#9c27b0!important}.border-color-deep-purple{border-color:#673ab7!important}.border-color-indigo{border-color:#3f51b5!important}.border-color-blue{border-color:#2196f3!important}.border-color-light-blue{border-color:#03a9f4!important}.border-color-cyan{border-color:#00bcd4!important}.border-color-teal{border-color:#009688!important}.border-color-green{border-color:#4caf50!important}.border-color-light-green{border-color:#8bc34a!important}.border-color-lime{border-color:#cddc39!important}.border-color-yellow{border-color:#ffeb3b!important}.border-color-amber{border-color:#ffc107!important}.border-color-orange{border-color:#ff9800!important}.border-color-deep-orange{border-color:#ff5722!important}.border-color-brown{border-color:#795548!important}.border-color-grey{border-color:#9e9e9e!important}.border-color-grey-half{border-color:hsla(0,0%,62%,.5)!important}.border-color-blue-grey{border-color:#607d8b!important}.border-color-dark-grey{border-color:#1e1e1e!important}.border-color-light-grey{border-color:#ececec!important}.border-color-black{border-color:#0a0a0a!important}.border-color-white{border-color:#fff!important}.border{border:.1rem solid}.border-radius{border-radius:.3rem!important}.border-default{border:.1rem solid #cdcdcd!important}.border-2{border-width:.2rem!important}.border-3{border-width:.3rem!important}.border-top{border-top:.1rem solid}.border-top-default{border-top:.1rem solid #cdcdcd!important}.border-top-2{border-top-width:.2rem!important}.border-top-3{border-top-width:.3rem!important}.border-right{border-right:.1rem solid}.border-right-default{border-right:.1rem solid #cdcdcd!important}.border-right-2{border-right-width:.2rem!important}.border-right-3{border-right-width:.3rem!important}.border-bottom{border-bottom:.1rem solid}.border-bottom-default{border-bottom:.1rem solid #cdcdcd!important}.border-bottom-2{border-bottom-width:.2rem!important}.border-bottom-3{border-bottom-width:.3rem!important}.border-left{border-left:.1rem solid}.border-left-default{border-left:.1rem solid #cdcdcd!important}.border-left-2{border-left-width:.2rem!important}.border-left-3{border-left-width:.3rem!important}.padding{padding:1.5rem!important}.padding-half{padding:.75rem!important}.padding-2{padding:3rem!important}.padding-3{padding:4.5rem!important}.padding-none{padding:0!important}.padding-top{padding-top:1.5rem!important}.padding-top-half{padding-top:.75rem!important}.padding-top-2{padding-top:3rem!important}.padding-top-3{padding-top:4.5rem!important}.padding-top-none{padding-top:0!important}.padding-right{padding-right:1.5rem!important}.padding-right-half{padding-right:.75rem!important}.padding-right-2{padding-right:3rem!important}.padding-right-3{padding-right:4.5rem!important}.padding-right-none{padding-right:0!important}.padding-bottom{padding-bottom:1.5rem!important}.padding-bottom-half{padding-bottom:.75rem!important}.padding-bottom-2{padding-bottom:3rem!important}.padding-bottom-3{padding-bottom:4.5rem!important}.padding-bottom-none{padding-bottom:0!important}.padding-left{padding-left:1.5rem!important}.padding-left-half{padding-left:.75rem!important}.padding-left-2{padding-left:3rem!important}.padding-left-3{padding-left:4.5rem!important}.padding-left-none{padding-left:0!important}.margin{margin:2rem!important}.margin-half{margin:1rem!important}.margin-2{margin:4rem!important}.margin-3{margin:6rem!important}.margin-none{margin:0!important}.margin-top{margin-top:2rem!important}.margin-top-half{margin-top:1rem!important}.margin-top-2{margin-top:4rem!important}.margin-top-3{margin-top:6rem!important}.margin-top-none{margin-top:0!important}.margin-right{margin-right:2rem!important}.margin-right-half{margin-right:1rem!important}.margin-right-2{margin-right:4rem!important}.margin-right-3{margin-right:6rem!important}.margin-right-none{margin-right:0!important}.margin-bottom{margin-bottom:2rem!important}.margin-bottom-half{margin-bottom:1rem!important}.margin-bottom-2{margin-bottom:4rem!important}.margin-bottom-3{margin-bottom:6rem!important}.margin-bottom-none{margin-bottom:0!important}.margin-left{margin-left:2rem!important}.margin-left-half{margin-left:1rem!important}.margin-left-2{margin-left:4rem!important}.margin-left-3{margin-left:6rem!important}.margin-left-none{margin-left:0!important}.width-full{width:100%!important}.width-half{width:50%!important}.width-zero{width:0!important}.height-full{height:100%!important}.height-half{height:50%!important}.height-zero{height:0%!important}.position-fixed{position:fixed!important}.position-absolute{position:absolute!important}.position-relative{position:relative!important}.position-sticky{position:sticky!important}.top-zero{top:0!important}.right-zero{right:0!important}.bottom-zero{bottom:0!important}.left-zero{left:0!important}.float-left{float:left!important}.float-right{float:right!important}.block{display:block!important}.inline-block{display:inline-block!important}.inline{display:inline!important}.hidden{display:none!important}.opacity{opacity:1!important}.opacity-none{opacity:0!important}.opacity-half{opacity:.5!important}.line-height-reset{line-height:1!important}.btn{cursor:pointer;display:-ms-inline-flexbox;display:inline-flex;display:-webkit-inline-flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;text-decoration:none;white-space:nowrap;height:3.8rem;line-height:3.8rem;padding:0 1.5rem;color:#222;font-size:1.7rem;background-color:transparent;border:.1rem solid #bbb;border-radius:.3rem;outline:0;margin:0 0 .8rem;text-transform:none}.btn:focus,.btn:hover{text-decoration:none;color:#2196f3;border-color:#2196f3}.btn-round{border-radius:4rem!important}.btn-square{border-radius:0!important}.btn-disable,.btn-disable:focus,.btn-disable:hover{color:#757575!important;background-color:#fff!important;border-color:#cdcdcd!important}.btn-disable:focus,.btn-disable:hover{cursor:default!important}.btn-primary{color:#fff!important;background-color:#2196f3!important;border-color:#2196f3!important}.btn-primary:focus,.btn-primary:hover{color:#fff!important;background-color:#0c82df!important;border-color:#0c82df!important}.btn-primary-inverse{color:#2196f3!important;background-color:transparent!important;border-color:#2196f3!important}.btn-primary-inverse:focus,.btn-primary-inverse:hover{color:#fff!important;background-color:#0c82df!important;border-color:#0c82df!important}.btn-full{width:100%!important;display:-ms-flexbox!important;display:flex!important;display:-webkit-flex!important}.image-responsive{width:100%!important;height:auto!important}.image-round{border-radius:50%!important}.text-center{text-align:center!important}.text-left{text-align:left!important}.text-right{text-align:right!important}.text-important{color:#f44336!important}.text-warning{color:#ff9800!important}.text-primary{color:#2196f3!important}.text-description{color:#757575!important}.text-uppercase{text-transform:uppercase!important}.text-lowercase{text-transform:lowercase!important}.text-capitalize{text-transform:capitalize!important}.text-title{font-size:4rem!important}@media (min-width:600px){.text-title{font-size:4.5rem!important}}.transition{-webkit-transition:all .35s ease-in-out!important;transition:all .35s ease-in-out!important}.cursor-default{cursor:default!important}.cursor-pointer{cursor:pointer!important}.cursor-none{cursor:none!important}.cursor-move{cursor:move!important}.btn-search{color:#fff!important;background-color:#f1f3f5!important;border-color:#f1f3f5!important}.btn-search:focus,.btn-search:hover{color:#fff!important;background:#f8f9fa!important;border-color:#f8f9fa!important}img{width:100%}h2{font-size:1.5em;-webkit-margin-before:.83em;margin-block-start:.83em;-webkit-margin-after:.83em;margin-block-end:.83em;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:0;margin-inline-end:0}h2,h3{display:block;font-weight:700}h3{font-size:1.17em;-webkit-margin-before:1em;margin-block-start:1em;-webkit-margin-after:1em;margin-block-end:1em;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:0;margin-inline-end:0}h4,h5{display:block;-webkit-margin-before:1.33em;margin-block-start:1.33em;-webkit-margin-after:1.33em;margin-block-end:1.33em;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:0;margin-inline-end:0;font-weight:700}h5{font-size:1.7rem}blockquote{margin:2rem 0;border-left:4px solid #20c997;border-top-right-radius:4px;border-bottom-right-radius:4px;background:#f8f9fa;padding:2rem;color:#212529;display:block;-webkit-margin-before:1em;margin-block-start:1em;-webkit-margin-after:1em;margin-block-end:1em;-webkit-margin-start:40px;margin-inline-start:40px;-webkit-margin-end:40px;margin-inline-end:40px}blockquote :first-child{margin-top:0}blockquote :last-child{margin-bottom:0}.ref{text-align:center;margin-bottom:30px;color:#20c997;font-size:13px}.plain-text{color:#fff}.language-text{color:#24292e!important;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-ms-hyphens:none;hyphens:none}.skill-icons{width:100px;height:100px}.main-container{display:-ms-flexbox;display:flex;display:-webkit-flex;-ms-flex-direction:column;flex-direction:column;min-height:750px}.main-container .content-wrapper,.main-container .sidebar-wrapper{width:100%}@media(min-width:1000px){.main-container{-ms-flex-direction:row;flex-direction:row}.main-container .content-wrapper{padding-right:3rem;border-right:1px solid #ececec;width:calc(100% - 330px)}.main-container .sidebar-wrapper{padding-left:3rem;width:330px}}.category{color:#000}.tags{margin-bottom:.875rem;background:#f1f3f5;padding-left:1rem;padding-right:1rem;height:3rem;border-radius:1rem;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;margin-right:.875rem;color:#0ca678;text-decoration:none;font-weight:500;font-size:1.5rem}.post-info-bottom{display:-ms-flexbox;display:flex;color:#757575!important}.post-info-bottom .separator{margin-left:.25rem;margin-right:.25rem;line-height:20px}.post-info-bottom .category{color:#757575!important;font-size:80%}.post-info-bottom .category:after{content:"\B7"}.post-info-bottom .category:last-child:after{content:" "}.article-container{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.article-container .thumbnail-wrapper .thumbnail-img{width:660px;max-width:100%}.article-container .post-info-wrapper{margin-top:2rem}@media(min-width:600px){.article-container{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.article-container .thumbnail-wrapper .thumbnail-img{width:300px}.article-container .post-info-wrapper{margin-top:unset}}.search{width:100%;position:relative;margin-top:30px}.search .search-input{display:-ms-flexbox;display:flex}.search .search-input .search-icon{margin:5px 20px 5px 5px}.pagination-container,.pagination-container .pagination-item{display:-ms-flexbox;display:flex;display:-webkit-flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.pagination-container .pagination-item{padding:.75rem 1rem;min-width:4.8rem;min-height:4.5rem;border-right:1px solid #dcdcdc;border-top:1px solid #dcdcdc;border-bottom:1px solid #dcdcdc}.pagination-container .pagination-item:hover{background-color:#f6f6f6;cursor:pointer}.pagination-container .pagination-item:first-child{border-left:1px solid #dcdcdc;border-top-left-radius:3px;border-bottom-left-radius:3px}.pagination-container .pagination-item:last-child{border-top-right-radius:3px;border-bottom-right-radius:3px}.pagination-container .pagination-item.active{background-color:#f0f0f0}.post-container .meta-share-wrapper .share-wrapper{padding-top:1rem;padding-bottom:.75rem}@media(min-width:600px){.post-container .meta-share-wrapper{display:-ms-flexbox;display:flex;display:-webkit-flex;-ms-flex-pack:justify;justify-content:space-between}.post-container .meta-share-wrapper .share-wrapper{padding-top:unset;padding-bottom:unset}}code[class*=language-],pre[class*=language-]{color:#fff;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0 1em;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;white-space:normal;background:rgba(27,31,35,.05);padding:.2em .4em;font-size:85%;border-radius:3px}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><meta name="generator" content="Gatsby 2.32.13"/><title data-react-helmet="true">kube-prometheus-stack으로 모니터링 시스템 구축하기 - LakeScript</title><link data-react-helmet="true" rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/><meta data-react-helmet="true" name="description" content="들어가며 사내에서 EFK-Stack(ElasticSearch+Fluent-bit+Kibana)를 이용하여 모니터링 시스템을 구축했었습니다. 하지만 AWS Opensearch를 이용하다보니 비용적인 문제와 비교적 활용도가 낮았던 fluent-bit…"/><meta data-react-helmet="true" name="image" content="https://leehosu.github.io"/><meta data-react-helmet="true" name="keywords" content="devops"/><meta data-react-helmet="true" property="og:url" content="https://leehosu.github.io/kube-prometheus-stack"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="kube-prometheus-stack으로 모니터링 시스템 구축하기"/><meta data-react-helmet="true" property="og:description" content="들어가며 사내에서 EFK-Stack(ElasticSearch+Fluent-bit+Kibana)를 이용하여 모니터링 시스템을 구축했었습니다. 하지만 AWS Opensearch를 이용하다보니 비용적인 문제와 비교적 활용도가 낮았던 fluent-bit…"/><meta data-react-helmet="true" property="og:image" content="https://leehosu.github.io"/><meta data-react-helmet="true" property="fb:app_id" content=""/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="kube-prometheus-stack으로 모니터링 시스템 구축하기"/><meta data-react-helmet="true" name="twitter:description" content="들어가며 사내에서 EFK-Stack(ElasticSearch+Fluent-bit+Kibana)를 이용하여 모니터링 시스템을 구축했었습니다. 하지만 AWS Opensearch를 이용하다보니 비용적인 문제와 비교적 활용도가 낮았던 fluent-bit…"/><meta data-react-helmet="true" name="twitter:image" content="https://leehosu.github.io"/><script data-react-helmet="true" async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2038621379918916" crossorigin="anonymous"></script><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://leehosu.github.io","name":"kube-prometheus-stack으로 모니터링 시스템 구축하기","alternateName":"LakeScript"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://leehosu.github.io/kube-prometheus-stack","name":"kube-prometheus-stack으로 모니터링 시스템 구축하기","image":"https://leehosu.github.io"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://leehosu.github.io","name":"kube-prometheus-stack으로 모니터링 시스템 구축하기","alternateName":"LakeScript","headline":"kube-prometheus-stack으로 모니터링 시스템 구축하기","image":{"@type":"ImageObject","url":"https://leehosu.github.io"},"description":"들어가며 사내에서 EFK-Stack(ElasticSearch+Fluent-bit+Kibana)를 이용하여 모니터링 시스템을 구축했었습니다. 하지만 AWS Opensearch를 이용하다보니 비용적인 문제와 비교적 활용도가 낮았던 fluent-bit…"}]</script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-2ZF5F3414R"></script><script>
    window.GATSBY_GTAG_PLUGIN_GA_TRACKING_ID = (
      'G-2ZF5F3414R'
    );
    window.GATSBY_GTAG_PLUGIN_ANONYMIZE = true;

    var options = {
      send_page_view: false
    };
    if (true) {
      options.anonymize_ip = true;
    }

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    window.gtag = gtag;
    gtag('js', new Date());
    gtag('config', 'G-2ZF5F3414R', options);
  </script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#2196F3"/><link rel="apple-touch-icon" sizes="192x192" href="/logos/logo-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/logos/logo-512x512.png"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-398e8795e5531745fb6f.js"/><link as="script" rel="preload" href="/app-be6aa568186f41ee1ded.js"/><link as="script" rel="preload" href="/styles-d92458a40376ac1079c2.js"/><link as="script" rel="preload" href="/framework-81481035b2cfdfa9d9ed.js"/><link as="script" rel="preload" href="/5a689306-b93556dcf695fd8d45c7.js"/><link as="script" rel="preload" href="/c16184b3-4d7cb95e09fa792a5d07.js"/><link as="script" rel="preload" href="/2cca2479-00397cf64e0564764281.js"/><link as="script" rel="preload" href="/e5ddc9d07ff53122a1bea9b3e73594ce6812cb5e-adfef642974b334bc570.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-jsx-82e87410d84186ad00a8.js"/><link as="fetch" rel="preload" href="/page-data/kube-prometheus-stack/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><nav class="navigation-container background-color-white"><div class="navigation-main container flex align-items-center justify-content-space-between"><div class="brand"><a class="flex align-items-center" href="/"><img class="image margin-right-half border-radius" src="data:image/png;base64,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" alt="Brand Image"/><span class="title"><strong>Lakescript</strong></span></a></div><div class="nav-links text-right"><a class="item margin-left" href="/about">About</a></div><div class="navbars cursor-pointer padding"><div class="hamburger "><span></span><span></span><span></span><span></span></div></div></div></nav><header class="border-bottom border-color-light-grey"><div class="container"><h1 class="margin-none padding-top-2 padding-bottom-2">kube-prometheus-stack으로 모니터링 시스템 구축하기</h1></div></header><section class="main-container container"><div class="content-wrapper padding-top-half padding-bottom-2"><div class="post-container"><div class="meta-share-wrapper padding-top padding-bottom"><div class="text-description meta-wrapper">     <!-- -->2023년 8월 27일</div><div class="flex share-wrapper"><button class="react-share__ShareButton cursor-pointer margin-right-half" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="26" height="26"><circle cx="32" cy="32" r="32" fill="#FF5700"></circle><path d="M 53.34375 32 C 53.277344 30.160156 52.136719 28.53125 50.429688 27.839844 C 48.722656 27.148438 46.769531 27.523438 45.441406 28.800781 C 41.800781 26.324219 37.519531 24.957031 33.121094 24.863281 L 35.199219 14.878906 L 42.046875 16.320312 C 42.214844 17.882812 43.496094 19.09375 45.066406 19.171875 C 46.636719 19.253906 48.03125 18.183594 48.359375 16.644531 C 48.6875 15.105469 47.847656 13.558594 46.382812 12.992188 C 44.914062 12.425781 43.253906 13.007812 42.464844 14.367188 L 34.625 12.800781 C 34.363281 12.742188 34.09375 12.792969 33.871094 12.9375 C 33.648438 13.082031 33.492188 13.308594 33.441406 13.566406 L 31.070312 24.671875 C 26.617188 24.738281 22.277344 26.105469 18.59375 28.609375 C 17.242188 27.339844 15.273438 26.988281 13.570312 27.707031 C 11.863281 28.429688 10.746094 30.089844 10.71875 31.941406 C 10.691406 33.789062 11.757812 35.484375 13.441406 36.257812 C 13.402344 36.726562 13.402344 37.195312 13.441406 37.664062 C 13.441406 44.832031 21.792969 50.65625 32.097656 50.65625 C 42.398438 50.65625 50.753906 44.832031 50.753906 37.664062 C 50.789062 37.195312 50.789062 36.726562 50.753906 36.257812 C 52.363281 35.453125 53.371094 33.800781 53.34375 32 Z M 21.34375 35.199219 C 21.34375 33.433594 22.777344 32 24.542969 32 C 26.3125 32 27.742188 33.433594 27.742188 35.199219 C 27.742188 36.96875 26.3125 38.398438 24.542969 38.398438 C 22.777344 38.398438 21.34375 36.96875 21.34375 35.199219 Z M 39.9375 44 C 37.664062 45.710938 34.871094 46.582031 32.03125 46.464844 C 29.191406 46.582031 26.398438 45.710938 24.128906 44 C 23.847656 43.65625 23.871094 43.15625 24.183594 42.839844 C 24.5 42.527344 25 42.503906 25.34375 42.785156 C 27.269531 44.195312 29.617188 44.90625 32 44.800781 C 34.386719 44.929688 36.746094 44.242188 38.6875 42.847656 C 39.042969 42.503906 39.605469 42.511719 39.953125 42.863281 C 40.296875 43.21875 40.289062 43.785156 39.9375 44.128906 Z M 39.359375 38.527344 C 37.59375 38.527344 36.160156 37.09375 36.160156 35.328125 C 36.160156 33.5625 37.59375 32.128906 39.359375 32.128906 C 41.128906 32.128906 42.558594 33.5625 42.558594 35.328125 C 42.59375 36.203125 42.269531 37.054688 41.65625 37.6875 C 41.046875 38.316406 40.203125 38.664062 39.328125 38.65625 Z M 39.359375 38.527344" fill="white"></path></svg><span class="react-share__ShareCount"></span></button><button class="react-share__ShareButton cursor-pointer margin-right-half" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="26" height="26"><circle cx="32" cy="32" r="32" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button><button quote="들어가며 사내에서 EFK-Stack(ElasticSearch+Fluent-bit+Kibana)를 이용하여 모니터링 시스템을 구축했었습니다. 하지만 AWS Opensearch를 이용하다보니 비용적인 문제와 비교적 활용도가 낮았던 fluent-bit…" class="react-share__ShareButton cursor-pointer margin-right-half" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="26" height="26"><circle cx="32" cy="32" r="32" fill="#0965FE"></circle><path d="M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z" fill="white"></path></svg><span class="react-share__ShareCount"></span></button><button class="react-share__ShareButton cursor-pointer" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg viewBox="0 0 64 64" width="26" height="26"><circle cx="32" cy="32" r="32" fill="#25A3E3"></circle><path d="m45.90873,15.44335c-0.6901,-0.0281 -1.37668,0.14048 -1.96142,0.41265c-0.84989,0.32661 -8.63939,3.33986 -16.5237,6.39174c-3.9685,1.53296 -7.93349,3.06593 -10.98537,4.24067c-3.05012,1.1765 -5.34694,2.05098 -5.4681,2.09312c-0.80775,0.28096 -1.89996,0.63566 -2.82712,1.72788c-0.23354,0.27218 -0.46884,0.62161 -0.58825,1.10275c-0.11941,0.48114 -0.06673,1.09222 0.16682,1.5716c0.46533,0.96052 1.25376,1.35737 2.18443,1.71383c3.09051,0.99037 6.28638,1.93508 8.93263,2.8236c0.97632,3.44171 1.91401,6.89571 2.84116,10.34268c0.30554,0.69185 0.97105,0.94823 1.65764,0.95525l-0.00351,0.03512c0,0 0.53908,0.05268 1.06412,-0.07375c0.52679,-0.12292 1.18879,-0.42846 1.79109,-0.99212c0.662,-0.62161 2.45836,-2.38812 3.47683,-3.38552l7.6736,5.66477l0.06146,0.03512c0,0 0.84989,0.59703 2.09312,0.68132c0.62161,0.04214 1.4399,-0.07726 2.14229,-0.59176c0.70766,-0.51626 1.1765,-1.34683 1.396,-2.29506c0.65673,-2.86224 5.00979,-23.57745 5.75257,-27.00686l-0.02107,0.08077c0.51977,-1.93157 0.32837,-3.70159 -0.87096,-4.74991c-0.60054,-0.52152 -1.2924,-0.7498 -1.98425,-0.77965l0,0.00176zm-0.2072,3.29069c0.04741,0.0439 0.0439,0.0439 0.00351,0.04741c-0.01229,-0.00351 0.14048,0.2072 -0.15804,1.32576l-0.01229,0.04214l-0.00878,0.03863c-0.75858,3.50668 -5.15554,24.40802 -5.74203,26.96472c-0.08077,0.34417 -0.11414,0.31959 -0.09482,0.29852c-0.1756,-0.02634 -0.50045,-0.16506 -0.52679,-0.1756l-13.13468,-9.70175c4.4988,-4.33199 9.09945,-8.25307 13.744,-12.43229c0.8218,-0.41265 0.68483,-1.68573 -0.29852,-1.70681c-1.04305,0.24584 -1.92279,0.99564 -2.8798,1.47502c-5.49971,3.2626 -11.11882,6.13186 -16.55882,9.49279c-2.792,-0.97105 -5.57873,-1.77704 -8.15298,-2.57601c2.2336,-0.89555 4.00889,-1.55579 5.75608,-2.23009c3.05188,-1.1765 7.01687,-2.7042 10.98537,-4.24067c7.94051,-3.06944 15.92667,-6.16346 16.62028,-6.43037l0.05619,-0.02283l0.05268,-0.02283c0.19316,-0.0878 0.30378,-0.09658 0.35471,-0.10009c0,0 -0.01756,-0.05795 -0.00351,-0.04566l-0.00176,0zm-20.91715,22.0638l2.16687,1.60145c-0.93418,0.91311 -1.81743,1.77353 -2.45485,2.38812l0.28798,-3.98957" fill="white"></path></svg></button></div></div><div class="post-divider border-bottom border-color-light-grey margin-bottom-half margin-top-half"></div><div class="padding-top padding-bottom"><small><div class="post-categories-container block"><b><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="folder-open" class="svg-inline--fa fa-folder-open " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" style="color:#555;width:20px"><path fill="currentColor" d="M88.7 223.8L0 375.8 0 96C0 60.7 28.7 32 64 32l117.5 0c17 0 33.3 6.7 45.3 18.7l26.5 26.5c12 12 28.3 18.7 45.3 18.7L416 96c35.3 0 64 28.7 64 64l0 32-336 0c-22.8 0-43.8 12.1-55.3 31.8zm27.6 16.1C122.1 230 132.6 224 144 224l400 0c11.5 0 22 6.1 27.7 16.1s5.7 22.2-.1 32.1l-112 192C453.9 474 443.4 480 432 480L32 480c-11.5 0-22-6.1-27.7-16.1s-5.7-22.2 .1-32.1l112-192z"></path></svg> <span><a class="text-uppercase" href="/category/devops">Devops</a>, </span><span><a class="text-uppercase" href="/category/kubernetes">Kubernetes</a>, </span><span><a class="text-uppercase" href="/category/promehtues">promehtues</a>, </span><span><a class="text-uppercase" href="/category/loki">loki</a>, </span><span><a class="text-uppercase" href="/category/grafana">grafana</a>, </span><span><a class="text-uppercase" href="/category/observability">Observability</a></span></b></div><div class="post-tags-container block padding-top-half"><b><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tags" class="svg-inline--fa fa-tags " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="color:#555;width:20px"><path fill="currentColor" d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5L0 80C0 53.5 21.5 32 48 32l149.5 0c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"></path></svg> <span><a class="text-uppercase" href="/tag/devops">Devops</a>, </span><span><a class="text-uppercase" href="/tag/kubernetes">Kubernetes</a>, </span><span><a class="text-uppercase" href="/tag/promehtues">promehtues</a>, </span><span><a class="text-uppercase" href="/tag/loki">loki</a>, </span><span><a class="text-uppercase" href="/tag/grafana">grafana</a>, </span><span><a class="text-uppercase" href="/tag/observability">Observability</a></span></b></div></small></div><div class="post-divider border-bottom border-color-light-grey margin-bottom-half margin-top-half"></div><div class="padding-top padding-bottom"><h1 id="들어가며" style="position:relative;"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0" aria-label="들어가며 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>들어가며</h1>
<p>사내에서 EFK-Stack(ElasticSearch+Fluent-bit+Kibana)를 이용하여 모니터링 시스템을 구축했었습니다. 하지만 AWS Opensearch를 이용하다보니 비용적인 문제와 비교적 활용도가 낮았던 fluent-bit(응답이 길면 Probe가 자꾸 문제가 발생), metirc 데이터 필요, 쿠버네티스에 맞지 않은 설정들등 다양한 이슈로 모니터링 시스템을 바꿔야 하는 요구 사항이 생겼습니다. 그러던 중 쿠버네티스 모니터링 시스템계의 또 하나의 터줏대감인 Prometheus, Loki, Grafana를 이용하여 새롭게 모니터링 시스템을 구축하였습니다.</p>
<blockquote>
<p>💡 개념적인 내용은 공식 문서와 ChatGPT를 참고하여 작성하였습니다.</p>
</blockquote>
<h1 id="overview" style="position:relative;"><a href="#overview" aria-label="overview permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h1>
<div style="width:100%">
<p><img src="/b476e79d8d7827d58677e505521e4550/overview.gif" alt="overview"></p>
</div>
<h1 id="prometheus" style="position:relative;"><a href="#prometheus" aria-label="prometheus permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prometheus</h1>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.303030303030305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVR42o1RO0sDQRDOPxH8IRa2CoKlopUPsPMFor2NYGWK1DE2NpIY0EYucolFDCbocRcu5PLSC3ghxHvs3tztxjkvhERMcIphZr/5dr5vN9KfHNBuQft9ykDk9wHnQXKJfnbU2F/VNhf08xNOyRCaSmY+JiN+Ic/PEqVkF3Ly3IxxGR1CU8k/0ThYq++uBMt8r7az3Dhc/59sxjB9nO41jzdoRaKqhAW2Q2gymbNQG9XK2taiEY+iYG17idbUgWy0HTjnY2TuUg4w+mZe59PKi9azCHpz9Po/NhPxzhGSUJE8TYGqTEtPoCm+XodykWTv6UvWa1VBffU7bai8+YYe7hiQaeERMeTjqJW+wtZ5uDGvY3Ym5WRuaV6w0glbSDpCyk4n3GJujMzBRUscKPvq4q8GLlzCbBNrZvb6nsuJzYnDel1sObFC1jeRnyku0QekwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="prometheus"
        title="prometheus"
        src="/static/a740d1b72f8e98e60002294fa2d3f7fa/7c811/prometheus-logo.png"
        srcset="/static/a740d1b72f8e98e60002294fa2d3f7fa/103f2/prometheus-logo.png 165w,
/static/a740d1b72f8e98e60002294fa2d3f7fa/748ba/prometheus-logo.png 330w,
/static/a740d1b72f8e98e60002294fa2d3f7fa/7c811/prometheus-logo.png 660w,
/static/a740d1b72f8e98e60002294fa2d3f7fa/d28e0/prometheus-logo.png 990w,
/static/a740d1b72f8e98e60002294fa2d3f7fa/64756/prometheus-logo.png 1200w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<h2 id="prometheus란" style="position:relative;"><a href="#prometheus%EB%9E%80" aria-label="prometheus란 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prometheus란?</h2>
<p>Prometheus는 SoundCloud에서 처음 개발된 오픈 소스 시스템 모니터링 및 알림 툴킷입니다. 2012년에 시작된 이후로 많은 회사와 조직이 Prometheus를 채택하였고, 매우 활발한 개발자와 사용자 커뮤니티를 가지고 있습니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 87.87878787878788%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACwUlEQVR42oVU7Y6bMBDM+7/GvUVV9VdbVVdVqnLtfeSa3JEPEkgAGwM2BjPdXY5c055UpBVr7B12dmc9875D33nUPmC52WPxcA9TVWjbFnVdoyLfGPNqZYmSrOt76A8rqHe/5Iz3Hl3XYcaBvGisRZ7nyLLs4s37bM65sz+tq7yEyTRqMwKyzUIIGIYBTdNgu90iWq8RRRHiOEaapvJXYAA/fJaN1961UKccBZkp9Hlv1lPqbAwqgcMYXBQFnp8j8Z2l4NzQVpCzrvUIw5jIUHXynnBeARkk3iBdLQTk+voaV1dX4p9Shfv5WnxtGqzjnM4PsMoi+RpTDzrJ7gwoC7LsdESaHGgjoKGGKFXIoaoy0LoQ+lXVID3mUq+WaBe5ku8XgAwwhB6l66FsT7QJsKV144VmYz0sBXNQ2zqUdSV+1/Uw1pHfvwLKBjn8/IhSfL4d67ba5/i+2Ip/VC0SyoqfrDjhZnE3fi9rvP8ZwZH0hssMxz8c0wSHeCf0LXW91Er8hjIqifJI01FX1Qv9Gvv0KBIKbwEyBTaRUdsQnUoysVSKTHspRUv09OAlI0+gSqlz/JnyKJuA5GRQ6FpANnmGOWXLzy6t8HF+GuXU1JgnscirosZ9m99cNiVwhiJK1ldL2YzpBz5EPsvSEPXssCftDXCNFUFzsKXp4jG8oDwCDginBP3TPbrlLVX7gJzEvDFWaNYEnjjLowIfqHZ9I5Q5M557SWAS9uQEKrrdLFETKCqNhyTHp3UqNGOa6S+rR/EVNev2EAllHtflcvkGZdoMhx2c0WhNibDf0E1DXaYuirDplsmPRymNI91ppQWEqTJlviz+raGnW+ThEWa9IZ9mVe3R7e5oDy9zjnM3eT1dBpM/7c36acHyeNpCp5nMtS8SuPhRvvd9dyGNt+yvDHspKmus9aPG+G3/6N4U9D/7DXw5c+hfSMjGAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CNCF"
        title="CNCF"
        src="/static/8755941b5003f2471579539608ddb03d/7c811/CNCF.png"
        srcset="/static/8755941b5003f2471579539608ddb03d/103f2/CNCF.png 165w,
/static/8755941b5003f2471579539608ddb03d/748ba/CNCF.png 330w,
/static/8755941b5003f2471579539608ddb03d/7c811/CNCF.png 660w,
/static/8755941b5003f2471579539608ddb03d/d28e0/CNCF.png 990w,
/static/8755941b5003f2471579539608ddb03d/70841/CNCF.png 1094w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>Prometheus는 2016년 Kubernetes 에 이어 두 번째 프로젝트로 Cloud Native Computing Foundation에 합류했으며, 서비스 운영을 위해 모니터링 시스템을 구축할 때 가장 널리 사용되는 툴 중 하나입니다.</p>
<h2 id="특징" style="position:relative;"><a href="#%ED%8A%B9%EC%A7%95" aria-label="특징 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>특징</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVR42m1Si47DIAzr/3/pnXYtz44CBZ9Ny9STLhLa4iSO421Bb6j5QKkVJWe01tBrIZZRCj+JK3rJqMzL/fp5ogaHXOrIT+aKpTFx6w82Y7CuK9Jx4DwSDL8bYtu2jYEjeFjmF2bGwvD6hrFuYCmli7CS2VgLy+e9x/v9HqTOOYQQBpY5vBM3N6EwKfcxwnFO2L7vF2Hv/c9pCskX/gzV1ZdvWxSRCw8unzXNLJ3+7dsK58PYdraOFj2CNbBUGaliENKGwLOlOsYdhXl6fQ2Vum72LWKfpxj6JemJ59nbPy1Rj3Dl6hOpfkDVttnH5UOhzhO7nvzTsAzWoLCPhyTU0FjIuuZUuxTHgcuKBf+ECtOTp4fzr/Hx+uH7jF9wrG7siIHb5QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="prometheus-point"
        title="prometheus-point"
        src="/static/501a3b0a5df3b550e5e082e669268e37/7c811/prometheus-point.png"
        srcset="/static/501a3b0a5df3b550e5e082e669268e37/103f2/prometheus-point.png 165w,
/static/501a3b0a5df3b550e5e082e669268e37/748ba/prometheus-point.png 330w,
/static/501a3b0a5df3b550e5e082e669268e37/7c811/prometheus-point.png 660w,
/static/501a3b0a5df3b550e5e082e669268e37/d28e0/prometheus-point.png 990w,
/static/501a3b0a5df3b550e5e082e669268e37/74b07/prometheus-point.png 1238w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<ul>
<li><strong>다차원 데이터 모델</strong>: 메트릭 이름과 키/값 쌍으로 시계열 데이터를 식별합니다.</li>
<li><strong>PromQL</strong>: 이러한 차원성을 활용할 수 있는 유연한 쿼리 언어입니다.</li>
<li><strong>분산 저장에 의존하지 않음</strong>: 단일 서버 노드가 자립적으로 작동합니다.</li>
<li><strong>HTTP를 통한 풀 모델</strong>: 시계열 데이터 수집이 HTTP를 통해 이루어집니다.</li>
<li><strong>서비스 발견 또는 정적 구성을 통한 타겟 발견</strong>: 다양한 그래핑 및 대시보드 지원 모드가 있습니다.</li>
</ul>
<p>위처럼 여러 특징이 있지만 주요 특징은 2가지로 요약됩니다.</p>
<p><strong>Pull-Based Monitoring</strong></p>
<p>기존의 Push-Based Monitoring 방식 대신에 Pull-Based Monitoring을 사용합니다. 대상 서버에 설치된 Exporter가 메트릭 정보를 수집하고, 이 데이터는 수집 서버가 주기적으로 가져가는 구조입니다. </p>
<p>즉, 클라이언트에서 서버로 데이터를 보내는 것(PUSH)가 아닌 서버가 클라이언트의 데이터를 수집(Pull) 방식입니다. 이러한 방식은 기존의 에이전트(agent) 방식보다 더 유연하고 관리하기 쉽습니다.</p>
<p><strong>시계열 데이터베이스(TSDB)</strong></p>
<p>관계형 데이터베이스(RDB) 대신 메트릭 이름과 key-value 쌍으로 식별되는 시계열 데이터 모델을 사용합니다. 이를 통해 대량의 정보를 빠르게 검색할 수 있습니다.</p>
<h2 id="architecture" style="position:relative;"><a href="#architecture" aria-label="architecture permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Architecture</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAADZklEQVR42jWSW2gjZRTHT7Ok6eqC4CL4IuIuCmFZn4oFH1RKQRBWLEhFRPRNqLgiq+J6gb4tFh9c15U+KG7xwd0sygpVcGMu7Waa627aSTuTJplJZjKXTCZzyUxmmpkk/fwS64EfBw58/++c8z8gy/L9Js8rsiRVOVF9xrC9jZ7bR6Kk9Bu84DN1zrdwoXfoo449eg4hBDhOY4L1gxKUG5XzxTb9A6UzNxiFew0Mw/hGllsPdF3/2+r1wkLbSQtSB/E8h3TDQLiORFFEhmkhtaUt9EV2ubm/+7NSoX4aMVSY5phZVuWqvCZKgi5/AuMfSyR55UEmHdZNDaqCfoGkqrcPmuo7kjV4XTT7Swd8e4mRzDfqO3tPDLQWPdDbaKApqNuoLjea4mxXM7Y1VSNdx/0A/E4r5XUUwtfaxT5XnfdV6U21wdzzWOqyXytd9Fnqo5FU/xD1zE/dvdwZ/uqXIe/Ke8HO91+EiD/vPM7x/JJlWRWMhvkcPJkvunytOFSE7WGjPD/qH5IY5Kky8toSwp+hgWWgo9EIHQr1xbbQhK2trWUik3s2RxBQ3isFcrncowRBnK5UKidhZJuAmCJk8oW3799LPu92jS3bcZDT9zzMwPX8gW6afavbRa5Qf2WfoiEeiy0kYrEz43WJdOnELlmCQqEALMsCpDaTJ25d/zaYy+ffL6ZTLzqGnhqbYdvWEBtyZHXNo65tDx1/gBSafBW7G8JM7WczgPga9JsN4E1j6vdIZGqnVIKxyxNjCmkCFnFGvreD/ovhcUZHenvoZaLIbtYvjMUw057IXfIlLobzV8enBFcvfwxAUdRLNE0vVGu12euXlmcaZequ0uQNtkwJdyI3pdw2IbUqdJMn4tZBPj1fJncnDbhi5ReDoZArVv+IyAje+vrXqYkq7hCpqopHtBEWDSeTyQTDMAgv3p6bm3NWVlYcUZLtGseju9Hoy2OxCQPlhi3tI5x/wzIPBQLT50/OTD8C+Xz+hfX19Xfj8fhiz7Yf3tjYeDK5uXkum82GbXzoNYYJYxPCyX+i525Hbp06+9TTE0Gzw/zoyGnkmuxNLHgqGAydnQlhweP5H8MEVldXIRqNQiKRgFQqBYIgAEmSEIvFAHcOa2trcO3ad4Hxm3Q6c7FQJP/K5vKf9RwD/o9/AVT1p3I0GeMkAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="prometheus-architecture"
        title="prometheus-architecture"
        src="/static/2ada1ece66fcc81d704c2ba46f9dd7d3/7c811/architecture.png"
        srcset="/static/2ada1ece66fcc81d704c2ba46f9dd7d3/103f2/architecture.png 165w,
/static/2ada1ece66fcc81d704c2ba46f9dd7d3/748ba/architecture.png 330w,
/static/2ada1ece66fcc81d704c2ba46f9dd7d3/7c811/architecture.png 660w,
/static/2ada1ece66fcc81d704c2ba46f9dd7d3/d28e0/architecture.png 990w,
/static/2ada1ece66fcc81d704c2ba46f9dd7d3/bb51b/architecture.png 1320w,
/static/2ada1ece66fcc81d704c2ba46f9dd7d3/f631a/architecture.png 1351w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>Exporter</strong></p>
<ul>
<li>host서버에 설치되어 메트릭 데이터를 수집하는 역할을 합니다.</li>
<li>Prometheus 서버가 접근하여 데이터를 가져올 수 있는 HTTP 엔드포인트를 제공하여 다양한 데이터를 수집합니다.</li>
</ul>
<p><strong>Prometheus Server</strong></p>
<ul>
<li>Prometheus Server는 메트릭 데이터를 스크랩하고 저장합니다.</li>
<li>메트릭 데이터 수집 주기를 설정하여 지정된 시간마다 대상 서버에 있는 Exporter로부터 데이터를 수집합니다.</li>
<li>수집한 데이터를 저장하고 PromQL(프로메테우스 쿼리 언어)를 사용하여 데이터를 쿼리하고 필터링할 수 있습니다.</li>
</ul>
<p><strong>Grafana</strong></p>
<ul>
<li>Grafana는 데이터 시각화 도구로, Prometheus가 수집한 메트릭 데이터를 그래프나 대시보드 형태로 시각화하여 표현할 수 있습니다.</li>
<li>Prometheus Server에서 직접 제공하는 웹 뷰보다 더 다양한 시각화 기능을 제공하며, Grafana를 통해 데이터를 더 직관적으로 이해할 수 있습니다.</li>
</ul>
<p><strong>Alertmanager</strong></p>
<ul>
<li>Prometheus가 수집한 메트릭 데이터를 기반으로 경고를 생성하고 규칙을 만들어 관리합니다.</li>
</ul>
<p>이렇듯 Prometheus로 metric 데이터를 수집하려고 했지만 Docker형태나 pod 형태로 배포하기엔 따로 작업을 해야해서 다른 방안이 없나하고 찾아보던 중 Prometheus, Grafana, Alertmanager 등을 함께 묶어 kubernetes 환경에 맞게 Helm 차트 형태로 설치할 수 있는 kube-prometheus-stack을 발견했습니다..!</p>
<h1 id="kube-prometheus-stack" style="position:relative;"><a href="#kube-prometheus-stack" aria-label="kube prometheus stack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>kube-prometheus-stack</h1>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEyUlEQVR42m1UbWxTVRg+dI6QiBgMoslkUxgR2t57W2DoohIimkWicbJkyygaWLeu6+3HFjKHGBN/oHwMAzqBCD8IweAw0R+GRFA+FAxixhjOIXQwut1z79267pt1S7e2r+97WqM/OMmbe+45533Oc573g7GHjBVbO5is9s2R/cZc2a8z2c89ssq9+I9zI1f29TGnL8weOiRvD7PXdiOANkfxczFXAmaOVNfDJJUzZ2iArQoZp9BaaU5r5IPAOVLtHTyrC1+bJ8zs3nsIWHcfJ3eJEW72Wxyh2BwERKfuR5FVpSNgtCyr5rywmuvOoPEFApZLteF5xFYJRi34teA5ZvN0I04PAfYQoEX29T6jBAcYGR7YqviNKILBilodgkdH0nVHRmeWe3RwBA1AEBNl2IwEmOQ3iWEBAlqygBECXIBa9aPtQtuHDqAEDLN4u+5jbGg+TA4eB+32g4YzsHJ5VeQ9vMigM3j204wZA3ZPeAG9lsl4iyxu4S/gxpQcMAHZ/QoAzHUkwa5cCrNpQwuMnz4CMDNR//5hjeEW+uiXUBpiG0eGRZngGYyAhAa4WIgL43RIUo3J9U1G4yzAWoBJlkqna4Z2ByD+24/tLABzl22LNCLL6QxLY0z4CgxuwUAMWBTBUj9KB1aHtM0YgI6K5mFImr0wOzH65mwytWvAWwKTpz4f/+EuXFvXqIO1zmhzBLTN2ad/ldE/miOCYnN35pIOaB357ihjjrOLXt2TuMC/a4Vk1+/9U22/RPn6xTDReiiVHh2ET06a5xm7tZCVmAzl+VNoWHMrN6OhqjGM8LPZmw4urTbYlq+B3QEoiLUemxn52A2DoVLQNy5NPfimJTX2/XGUF4p3fptgi7aY9LKD5IvBfY5Sj6qAFvOFwCpvLtnRnfdERaTpxOXE1elmFbTXlqSMUmvKLHfC4EdV6akvm+DQT4lrC8vv73hj5/089N2T9S0gHZmiRuYjyy3ZVJlSVB3soRhcPHcbxl1Kmr9tA7NMAuMdKxgVa2DE5Ux3XmiDtTtGQPJx4SNep/IqlO9xCnU3Wh+lDG4mrZ7IgfX7wTt8/gzvL7MjkD1lbrKnhZXJab4hD+Inm2d2X4adS1x3P8RET4p08+sR/N6jJzso5yipERBsVbeLrK+cZg/ar7abFasQ0JY0N0kgAMudab2kAIZPHyMd5z1Wcn0VVRP67i3+DCgediYSErsHBuYpjFgc63WQscpcdPDE9jdC77onZ/VSW0pHHftez5/R330ZgHeee/oALMZnDiGJBPrmCQwMMCUjtalHRGtSeRmxRG3+emkfrIQ4PzW11wuxSifEXGtgcvtbAG1n9JNtoBa6tZuOoAiGC32YwMCWJ5pB4YZd9LVQl0HG2xwYNZuXjxd/MHz47I3pn3v/6Pi791p71/nrYx2VLfELy2v4mADz6z4qXeo6dvcNpoRi2Z6IPVCq6aK6ziGmkk/bSKCST4elbg5S/RBIDUOAOQorPBwIDNvYJqx7IoJ9MYwFcu+/JiuS268RoCXTLPQDCHxldbD3+aIQDyo+bZ/s05rXhHjDiw19Vty/iPtHRbmRj59n9Pv/oCx31I9m+qGft6A2pRQwbBTM6utnK9FonnHmG6h+5UCUOTw3xdq/4x/JLB0HySrfLwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="kps"
        title="kps"
        src="/static/6b270f686608d58dc036437bdf92f868/d9f49/kube-prometheus-stack.png"
        srcset="/static/6b270f686608d58dc036437bdf92f868/103f2/kube-prometheus-stack.png 165w,
/static/6b270f686608d58dc036437bdf92f868/748ba/kube-prometheus-stack.png 330w,
/static/6b270f686608d58dc036437bdf92f868/d9f49/kube-prometheus-stack.png 400w"
        sizes="(max-width: 400px) 100vw, 400px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<h2 id="kube-prometheus-stack이란" style="position:relative;"><a href="#kube-prometheus-stack%EC%9D%B4%EB%9E%80" aria-label="kube prometheus stack이란 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kube-Prometheus-Stack이란?</h2>
<p>kube-prometheus-stack은 kubernetes cluster에 맞게 구성된 오픈 소스 프로젝트입니다. Prometheus를 기반으로 하며, 쿠버네티스 클러스터의 다양한 컴포넌트들의 메트릭 데이터를 수집하고 이를 시계열 데이터로 생성하여 모니터링 및 경고 기능을 제공합니다.</p>
<p>즉, 쿠버네티스 클러스터만 있다면 간단하게 helm chart로 설치가 가능합니다!</p>
<p>github : <a href="https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack">https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack</a></p>
<h2 id="architecture-1" style="position:relative;"><a href="#architecture-1" aria-label="architecture 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Architecture</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.36363636363636%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACG0lEQVR42iWSO2/UQBSF/U8paOj5BxTU/AKEEBQUUABCCkiRQChISEmIssnu2hvHj7HHO573wx7PeDwYcouj2xzdo/PdRCsBYdOC0kge/09Y/ul14d6eqhoASvCyRDcvkw9MaqWHEJbJzXMIiahznqdMKoT6I+XWzVKPzEybavi50UIIH8Iw+YKMFTF1tq8rwJQR2ipjkzrb3V79yYmtjqzAqrm+Nptz7SMgusQay/FQ1BAzZhxT1h++8zbfHQoqlB6nZJ93J79bKk3bs1Wr+7K+uRScv/hWPXm9O8voMkmjNGSDn5dhDtbPa/7BOj+HBNRwk0FmLCQKYr5vyI8NyI76yxV6c9au5l+Fvs8azrW2XsGWc0m4ZGvu0SZtBbYXN0VDyo4Rxr/e4Mevds8/588+5k/fZc8/3T16efv+dK/MeAcZPvnQAZAXVVG3qj0maVpus7rjY4lkfaQFNvtGFHiokazq/qgnIB1ukJPahzX2MobFzmEI0ROacEq2gO4aSoQK0xgecBkdlRjvSlF2kfTxkMbdNpZlJCT2KEoZwxwJThY/BW+Ds4JiKYQyw8rQrZ0skaRlc5GGPPfnl+78wt9uHWgnyjzjjgknVfJwaXL+HnRpXgB41KOjQiPKtXUr/56rHhHeoZ7yFYe0HkvN1ECUXc3rQy1r81SNEGHMpDBT17MSQCaHBtF1qTuM5VC3CPaEqxHAHiKCmP4Lf01chc89qw4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="kps-architecture"
        title="kps-architecture"
        src="/static/ec9145e6291d38ca2d6b4a310a081b2a/7c811/architecture-kube-prometheus.png"
        srcset="/static/ec9145e6291d38ca2d6b4a310a081b2a/103f2/architecture-kube-prometheus.png 165w,
/static/ec9145e6291d38ca2d6b4a310a081b2a/748ba/architecture-kube-prometheus.png 330w,
/static/ec9145e6291d38ca2d6b4a310a081b2a/7c811/architecture-kube-prometheus.png 660w,
/static/ec9145e6291d38ca2d6b4a310a081b2a/d28e0/architecture-kube-prometheus.png 990w,
/static/ec9145e6291d38ca2d6b4a310a081b2a/bbbf7/architecture-kube-prometheus.png 1280w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>Prometheus Operator</strong></p>
<ul>
<li>쿠버네티스 내에서 Prometheus 서버와 관련된 리소스들을 관리하기 위한 컨트롤러입니다.</li>
<li>Prometheus와 관련된 설정, 서비스 디스커버리, 룰 및 대시보드를 관리할 수 있습니다.</li>
</ul>
<p><strong>Prometheus Server</strong></p>
<ul>
<li>고가용성을 제공하는 Prometheus 서버입니다.</li>
<li>메트릭 데이터를 스크랩하고 저장합니다.</li>
</ul>
<p><strong>Alertmanager</strong></p>
<ul>
<li>Prometheus가 수집한 메트릭 데이터를 기반으로 경고를 생성하고 관리하는 역할을 합니다.</li>
</ul>
<p><strong>Prometheus node-exporter</strong></p>
<ul>
<li>node-exporter는 Host의 metric을 수집하는 역할을 합니다.</li>
<li>CPU, 메모리, 디스크 사용량 등의 데이터를 수집하여 Prometheus로 전달합니다.</li>
</ul>
<p><strong>Prometheus Adapter for Kubernetes Metrics APIs</strong></p>
<ul>
<li>쿠버네티스의 메트릭 API와 연동하여 클러스터 내부의 리소스 메트릭 데이터를 수집하고 Prometheus로 전달합니다.</li>
</ul>
<p><strong>kube-state-metrics</strong></p>
<ul>
<li>쿠버네티스 클러스터의 상태 정보를 메트릭으로 수집합니다.</li>
<li>파드, 디플로이먼트, 노드 등의 상태 정보를 모니터링할 수 있습니다.</li>
</ul>
<p><strong>Grafana</strong></p>
<ul>
<li>Grafana는 데이터 시각화 및 대시보드 생성 도구로, 수집한 메트릭 데이터를 그래프나 대시보드 형태로 시각화하여 사용자에게 제공합니다.</li>
</ul>
<h2 id="구성" style="position:relative;"><a href="#%EA%B5%AC%EC%84%B1" aria-label="구성 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>구성</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 268px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 116.36363636363636%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCUlEQVR42qWVV2/DMAyE7Qxk772XnT0RJEAe8v9/FouPAFEXbVM5fSBEyMqJxzsqXq1Wk2w2K4VCQUajkQwGA+n3+9JsNjVvtVpSr9cll8uJ53l/R7vdVsDxeCyPx0MOh4Ps93vZ7XZyOp10n4tKpZIbYKfT0cNUtVwupdvtSj6fl9VqpRU6gUQDgGq1qj++XC5yPp+1qtvtpnQ55Pu+O6BRhtb1epXn8ymTyUSGw6Hux64QwGKxqI1fLBZKvdFoxAeyAIikXC4rRVb6B3gymfwfIEGFgAVBIMfjUaunh6lUStLptK4vL4oC4kn8BxDCzGYzCcNQ8/V6rRchIvsm1jfBDBCl6ScBZdTGk9vtVkUCDF+Ss49PEZKLEonEJyBVkeA9quz1evrjzWajh/EmlqKq+XyuYHzHBZwhJ6wwVRljUyETAl0qJLdxo2dUwWo5+/SU/AttLMJmpVJRutx2v98VEIGm06lkMpn3VAYcM0MNMegf36GMMLEAoU3gRfpFMIqsjGFUWSdAowwgjYeqNd2Ee4syPkRdKgKUHLoEwtEO9p0oMxVUyQ+YFMDYR20Y8AhT7cu3MUoZuvgQMOhiZPzGt9iUDZDRQmGbBuzDRPAQ28q0/Pq0GSC08Bs9tCmx3hl9LrQR5ZH4ERAAbkMUFDXLMC1Qtr6xOlEGjMoQxHpo4jAp0cMufwUfOs4XGG/IMywAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="kps-chart"
        title="kps-chart"
        src="/static/6e3dd2ffffd6c38801fee546e6edc792/baf7c/kps-helm.png"
        srcset="/static/6e3dd2ffffd6c38801fee546e6edc792/103f2/kps-helm.png 165w,
/static/6e3dd2ffffd6c38801fee546e6edc792/baf7c/kps-helm.png 268w"
        sizes="(max-width: 268px) 100vw, 268px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>kube-prometheus-stack을 포함한 대부분의 Helm 배포 패키지는 비슷한 구성으로 이루어져있습니다.</p>
<p><strong>charts</strong> </p>
<ul>
<li>Helm 차트의 종속 차트를 포함하는 위치입니다.</li>
<li>이 패키지의 경우 grafana, kube-state-metrics, prometheus-node-exporter가 존재합니다.</li>
</ul>
<p><strong>templates</strong></p>
<ul>
<li>Helm 차트의 템플릿 파일들을 포함합니다.</li>
<li>템플릿은 Kubernetes 리소스의 정의를 작성하는 데 사용되며, 애플리케이션의 배포, 서비스, 구성 등을 관리할 수 있습니다</li>
</ul>
<p><strong>crds</strong> </p>
<ul>
<li>Custom Resource Definitions(CRDs) 파일을 포함할 수 있는 위치입니다.</li>
<li>Kubernetes API에 사용자 정의 리소스와 그에 대한 스키마를 추가하는 데 사용됩니다.</li>
</ul>
<p><strong>Chart.yaml</strong> </p>
<ul>
<li>Helm 차트의 메타 정보를 정의합니다.</li>
<li>메타 정보에는 차트의 이름, 버전, 유형, 유지 보수자 정보 등이 포함됩니다.</li>
<li>종속 차트, 애플리케이션의 버전 제약 조건 등을 지정할 수도 있습니다.</li>
</ul>
<p><strong>values.yaml</strong></p>
<ul>
<li>Helm 차트의 기본 구성 값을 정의합니다.</li>
<li>애플리케이션의 설정 옵션, 환경 변수, 리소스 크기 등을 설정할 수 있습니다.</li>
<li><code class="language-text">values.yaml</code> 파일에 정의된 값은 템플릿 파일 내에서 사용될 수 있으며, 차트를 배포할 때 사용자 지정 값으로 수정하여 배포할 수도 있습니다.</li>
</ul>
<h2 id="설치하기" style="position:relative;"><a href="#%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0" aria-label="설치하기 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설치하기</h2>
<h3 id="create-namespace" style="position:relative;"><a href="#create-namespace" aria-label="create namespace permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>create namespace</h3>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ kubectl create namsespace monitoring</code></pre></div>
<p>먼저 KPS을 설치할 네임스페이스를 생성합니다.</p>
<h3 id="add-helm-repo" style="position:relative;"><a href="#add-helm-repo" aria-label="add helm repo permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add Helm repo</h3>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token comment"># 헬름 차트의 저장소 추가</span>
$ helm repo <span class="token function">add</span> prometheus-community https://prometheus-community.github.io/
$ helm repo update</code></pre></div>
<p>Helm을 통해 prometheus-community repo를 cluster에 받아옵니다.</p>
<h3 id="pull-helm-config-file" style="position:relative;"><a href="#pull-helm-config-file" aria-label="pull helm config file permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pull helm config file</h3>
<p>몇가지 커스텀을 해야하기 때문에 config에 대한 값을 수정할 수 있는 manifast file을 다운로드 한 후 압축을 풀어줍니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ helm pull prometheus-community/kube-prometheus-stack
$ <span class="token function">tar</span> xvfz kube-prometheus-stack-<span class="token variable">${version}</span>.tgz <span class="token comment">#설치된 버전을 작성하시면 됩니다!</span></code></pre></div>
<h3 id="service-수정" style="position:relative;"><a href="#service-%EC%88%98%EC%A0%95" aria-label="service 수정 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>service 수정</h3>
<p>대시보드 형태로 외부에서 접근할 수 있게 <code class="language-text">prometheus-grafana</code>만 clusterIP에서 LoadBalancer나 NodePort로 변경합니다. (이 글에선 loadbalancer로 설정하였습니다)</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">...</span>
<span class="token key atrule">grafana</span><span class="token punctuation">:</span>
	<span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
	<span class="token punctuation">...</span>
	<span class="token comment">## Passed to grafana subchart and used by servicemonitor below</span>
  <span class="token comment">##</span>
  <span class="token key atrule">service</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> LoadBalancer
    <span class="token key atrule">portName</span><span class="token punctuation">:</span> http<span class="token punctuation">-</span>web
<span class="token punctuation">...</span></code></pre></div>
<p>그 후 수정된 values.yaml 파일을 paramater로 주어 helm chart를 배포합니다. </p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ helm <span class="token function">install</span> prometheus <span class="token builtin class-name">.</span> <span class="token parameter variable">-n</span> monitoring <span class="token parameter variable">-f</span> values.yaml</code></pre></div>
<h3 id="service-확인" style="position:relative;"><a href="#service-%ED%99%95%EC%9D%B8" aria-label="service 확인 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>service 확인</h3>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get svc <span class="token parameter variable">-n</span> mornitoring</code></pre></div>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 511px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5klEQVR42i2QW2vCQBBGvyQmWRW0UdvGxNxNvAR9LIggFPrUh/7/f3M6oA+HGWZnzuyuvLZF5xF13ZNhQJ8pShK0WDzjZo3mls+ETi/WwnkxZVzSuobOdSyDJfLzHNU1yneoqFBmcW/Srkel1YejndvSeI6mHtr51mdEIlZE4TLqaUk3rVmFb0i9DY5XkzSoL59UWxOv0Ic1zAKT2Y1kOGP/IhSBCVM1JMrYqMDJXhG3PdG5JTzcCA6/TK5/uOEHbe9E1QPXPIjSLzQ54a9HQvse/zgSrM60+Tvf45bbZcn9knCoZvwDCRJhtosvW68AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="promehteus-service"
        title="promehteus-service"
        src="/static/af33bfb74fe139bbca28585779045e35/40f84/prometheus-service.png"
        srcset="/static/af33bfb74fe139bbca28585779045e35/103f2/prometheus-service.png 165w,
/static/af33bfb74fe139bbca28585779045e35/748ba/prometheus-service.png 330w,
/static/af33bfb74fe139bbca28585779045e35/40f84/prometheus-service.png 511w"
        sizes="(max-width: 511px) 100vw, 511px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>배포되어있는 service를 확인해보면 정상적으로 prometheus-grafana의 servive type이 LoadBalancer로 설정되어 배포된 것을 확인할 수 있고, <code class="language-text">EXTERNAL-IP</code> 에 명시된 외부 IP 주소로 접근하실 수 있습니다. </p>
<p>(후에 AWS Route53와 같은 DNS service를 통해 해당 주소를 routing 해주시면 좋습니다!)</p>
<p>자! metric data 수집과 모니터링 구축은 완료했습니다. 이제 log를 수집해보겠습니다.</p>
<h1 id="loki-stack" style="position:relative;"><a href="#loki-stack" aria-label="loki stack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loki-Stack</h1>
<h2 id="loki-stack이란" style="position:relative;"><a href="#loki-stack%EC%9D%B4%EB%9E%80" aria-label="loki stack이란 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loki-stack이란?</h2>
<p>Loki-Stack은 Loki 로깅 엔진을 포함하지만, 추가적으로 로그를 수집, 집계, 시각화하기 위한 다른 컴포넌트들도 함께 제공합니다. </p>
<ul>
<li><strong>Loki</strong>: 로그 데이터를 저장하고 쿼리합니다.</li>
<li><strong>Promtail</strong>: 로그 데이터를 수집하고 Loki로 전송합니다.</li>
<li><strong>Grafana</strong>: 로그 데이터를 시각화합니다.</li>
</ul>
<h3 id="loki-vs-loki-stack" style="position:relative;"><a href="#loki-vs-loki-stack" aria-label="loki vs loki stack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loki VS Loki-Stack</h3>
<table>
<thead>
<tr>
<th></th>
<th>구성 요소</th>
<th>기능 범위</th>
<th>용도</th>
<th>설치 및 관리</th>
</tr>
</thead>
<tbody>
<tr>
<td>loki</td>
<td>로깅 엔진</td>
<td>로그 저장 및 쿼리에 중점</td>
<td>다른 로깅 시스템이나 시각화 도구와 통합</td>
<td>단일 컴포넌트로 더 간단하게 설치 및 관리</td>
</tr>
<tr>
<td>loki-stack</td>
<td>로깅 엔진, 로그 수집기, 시각화 도구까지 포함</td>
<td>로그 수집부터 저장, 쿼리, 시각화까지 전체 로깅 파이프라인 제공</td>
<td>독립적인, 통합된 로깅 솔류션을 제공</td>
<td>여러 컴포넌트를 관리해야하므로 설정과 관리 복잡</td>
</tr>
</tbody>
</table>
<p>loki만이 아니라 promtail과 여러 컴포넌트를 쉽게 사용할 수 있는 loki-stack을 선택해서 배포하도록 하겠습니다. </p>
<h2 id="설치" style="position:relative;"><a href="#%EC%84%A4%EC%B9%98" aria-label="설치 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>설치</h2>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/grafana/helm-charts</code></pre></div>
<p>위의 명령어로 helm chart를 받아옵니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">cd</span> helm-charts/charts/loki-stack</code></pre></div>
<p>grafana/helm-chart 레포지토리를 clone하여 받아온 후 loki-stack 디렉토리로 이동합니다.</p>
<p><strong>디렉토리 구조</strong></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">./                                
├── Chart.yaml                    
├── README.md                     
├── charts                        
│   ├── filebeat-7.17.3.tgz       
│   ├── fluent-bit-2.6.0.tgz      
│   ├── grafana-6.43.5.tgz        
│   ├── logstash-7.17.3.tgz       
│   ├── loki-2.16.0.tgz           
│   ├── prometheus-15.5.4.tgz     
│   └── promtail-6.14.1.tgz       
├── requirements.lock             
├── requirements.yaml             
├── templates                     
│   ├── NOTES.txt                 
│   ├── _helpers.tpl              
│   ├── datasources.yaml          
│   └── tests                     
└── values.yaml</code></pre></div>
<p>loki-stack 디렉토리에서 values.yaml 파일을 수정하여 원하는 기능을 키고 끄고 추가로 설정할 수 있습니다.</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">...</span>
<span class="token key atrule">loki</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token punctuation">...</span>
<span class="token key atrule">promtail</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token punctuation">...</span>
<span class="token key atrule">grafana</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token punctuation">...</span></code></pre></div>
<p>저희가 사용할 서비스는 loki와 promtail 인데 기본값이 <code class="language-text">enabled:true</code> 이기 때문에 수정하지 않고 배포합니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">$ helm <span class="token function">install</span> loki-stack <span class="token builtin class-name">.</span> <span class="token parameter variable">--namespace</span> monitoring</code></pre></div>
<hr>
<h3 id="배포시-오류" style="position:relative;"><a href="#%EB%B0%B0%ED%8F%AC%EC%8B%9C-%EC%98%A4%EB%A5%98" aria-label="배포시 오류 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>배포시 오류</h3>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">helm <span class="token function">install</span> loki-stack <span class="token builtin class-name">.</span> <span class="token parameter variable">--namespace</span> monitoring                                │
Error: INSTALLATION FAILED: An error occurred <span class="token keyword">while</span> checking <span class="token keyword">for</span> chart dependencies. You may need to run <span class="token variable"><span class="token variable">`</span>helm dependency build<span class="token variable">`</span></span> to fetc│
h missing dependencies: found <span class="token keyword">in</span> Chart.yaml, but missing <span class="token keyword">in</span> charts/ directory: loki, promtail, fluent-bit, grafana, prometheus, filebeat│
, logstash</code></pre></div>
<p>만약 설치시 위와 같이 문제가 생긴다면 <code class="language-text">helm dependency build</code> 을 통해 의존성을 설치하신 후 진행하시면 됩니다.</p>
<hr>
<h2 id="확인" style="position:relative;"><a href="#%ED%99%95%EC%9D%B8" aria-label="확인 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>확인</h2>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get po <span class="token parameter variable">-n</span> monitoring</code></pre></div>
<p>조금 후 해당 namespace의 pod 목록을 출력해보면 아래와 같이 Running이 되고 있습니다!설치가 완료되었습니다…!</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 29.6969696969697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABIElEQVR42mWPy3KDMAxFLzbBxsaGEpLwSiDZ9GP6/3+jsSritpsuzkhja46uMI0DNedPqm9fpDpFpq0pdB35GCn2PUXpT3VNqqqoMobaNpKrHbWxJWst9TLjvSPnPCmlCep6ZVwGRusYPjAawVqGsblWRt49wwlGcxHBXntezMLeeJYlrArwOBasFBiYl4RlTdifUqXftiSiBOA/WghIQYX0ql4p2pB0qd9/zx3JmGNunhm3kTEKR7+ujCP1QddJ8pYRQk58KuQCsCscL6ecUGlJLQn7/kh3sN4Z05xZRDZNsuDGuMv7tuV6ueTTS7yFjWr4Xq3cmIZ1Wb6F5/OvcNtzqvuD5WyRLozHI9eDj/5nsMjCkIV7tXOw4U84DFn4DfB9hl2QLd/8AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="loki-get-po"
        title="loki-get-po"
        src="/static/e58d400ddc99fd66db784c9952919117/7c811/loki-stack-get.png"
        srcset="/static/e58d400ddc99fd66db784c9952919117/103f2/loki-stack-get.png 165w,
/static/e58d400ddc99fd66db784c9952919117/748ba/loki-stack-get.png 330w,
/static/e58d400ddc99fd66db784c9952919117/7c811/loki-stack-get.png 660w,
/static/e58d400ddc99fd66db784c9952919117/d28e0/loki-stack-get.png 990w,
/static/e58d400ddc99fd66db784c9952919117/bb51b/loki-stack-get.png 1320w,
/static/e58d400ddc99fd66db784c9952919117/10796/loki-stack-get.png 1354w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<h3 id="promtail에서-로그가-수집안되는-이슈" style="position:relative;"><a href="#promtail%EC%97%90%EC%84%9C-%EB%A1%9C%EA%B7%B8%EA%B0%80-%EC%88%98%EC%A7%91%EC%95%88%EB%90%98%EB%8A%94-%EC%9D%B4%EC%8A%88" aria-label="promtail에서 로그가 수집안되는 이슈 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>promtail에서 로그가 수집안되는 이슈</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 6.0606060606060606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAQ0lEQVR42mMQkJT7LyKn+l9UUQNMg/jCcir/BaXk/wvLgmgFoJg8mBaSUfrPLy7zn19C9r+QtCJYXlhW+T+fqBRcHQAFQBnzyTOEFQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="promtail"
        title="promtail"
        src="/static/0ed47a4b0f466ee94c23c33e2c95dcb2/7c811/promtail.png"
        srcset="/static/0ed47a4b0f466ee94c23c33e2c95dcb2/103f2/promtail.png 165w,
/static/0ed47a4b0f466ee94c23c33e2c95dcb2/748ba/promtail.png 330w,
/static/0ed47a4b0f466ee94c23c33e2c95dcb2/7c811/promtail.png 660w,
/static/0ed47a4b0f466ee94c23c33e2c95dcb2/d28e0/promtail.png 990w,
/static/0ed47a4b0f466ee94c23c33e2c95dcb2/bb51b/promtail.png 1320w,
/static/0ed47a4b0f466ee94c23c33e2c95dcb2/08db2/promtail.png 3402w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>위의 사진처럼 promtail에서 log를 수집할 때에 error level의 로그 수집 오류 내용이 발생할 수 있습니다. 해당 이슈의 원인은 비교적 설치 시간이 짧은 promtail이 loki보다 먼저 설치되어 발생한 이슈인데, promtail Pod를 재시작해주면 해결됩니다!</p>
<h2 id="retention" style="position:relative;"><a href="#retention" aria-label="retention permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Retention</h2>
<p>기본적으로 <code class="language-text">table_manager.retention_deletes_enabled</code>또는 <code class="language-text">compactor.retention_enable</code>플래그가 설정되지 않은 경우 Loki로 전송된 로그는 영원히 유지됩니다.</p>
<p>table_manager 통한 보존은 객체 저장소 TTL 기능을 사용하며 boltdb-shipper store와 chunk/index store 에서 작동합니다. 그러나 Compactor을 통한 로그 보관은 boltdb-shipper store 에서만 지원됩니다.</p>
<h3 id="boltdb-shipper" style="position:relative;"><a href="#boltdb-shipper" aria-label="boltdb shipper permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>boltdb-shipper</h3>
<p>Grafana Loki에서 사용되는 index 및 chunk 데이터를 저장하는 데 사용되는 저장소 엔진 중 하나입니다.</p>
<p><strong>특징</strong></p>
<ul>
<li>인덱스와 로그 청크 모두를 객체 저장소(예: Amazon S3, Google Cloud Storage 등)에 저장합니다.</li>
<li>객체 저장소만을 사용하기 때문에, 일반적으로 비용이 더 저렴합니다.</li>
<li>수평 확장이 가능하며, 큰 규모의 로그 데이터를 처리할 수 있습니다.</li>
<li>Loki의 Compactor 컴포넌트와 함께 사용할 때 더 세밀한 데이터 보존 정책을 설정할 수 있습니다.</li>
<li>인덱스 데이터를 로컬에 캐싱할 수 있어, 쿼리 성능이 향상될 수 있습니다.</li>
</ul>
<h3 id="table_manager" style="position:relative;"><a href="#table_manager" aria-label="table_manager permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>table_manager</h3>
<p>Loki 데이터베이스의 핵심 구성 요소로서 로그 데이터의 저장, 유지 관리, 압축 및 정리를 관리하며 데이터베이스의 성능과 공간 효율성을 유지하는 역할을 합니다.</p>
<p><strong>특징</strong></p>
<ul>
<li>로그 데이터를 시간별로 테이블에 저장하는 형태로 데이터를 구성하며, 이를 통해 검색 성능을 최적화합니다.</li>
<li>설정된 로그 보존 기간 내에 있는 데이터만을 유지하고, 설정보다 오래된 데이터는 자동으로 삭제합니다.</li>
<li>인덱스 관리</li>
<li>데이터를 정리하고 필요한 경우 압축하여 저장 공간을 효율적으로 관리합니다.</li>
<li>설정된 보존 기간이 지난 로그 데이터를 정기적으로 삭제하여 데이터베이스의 용량을 유지합니다.</li>
</ul>
<p><strong>설정하기</strong></p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">...</span>
<span class="token key atrule">loki</span><span class="token punctuation">:</span>
	<span class="token punctuation">...</span>
	<span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token key atrule">table_manager</span><span class="token punctuation">:</span>
      <span class="token key atrule">retention_deletes_enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">retention_period</span><span class="token punctuation">:</span> 24h
<span class="token punctuation">...</span></code></pre></div>
<h3 id="compactor" style="position:relative;"><a href="#compactor" aria-label="compactor permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Compactor</h3>
<p><strong>특징</strong></p>
<ul>
<li><code class="language-text">boltdb-shipper</code> 저장소에서만 지원됩니다.</li>
<li>단일 인스턴스(싱글톤)로 실행하는 것이 권장됩니다.</li>
<li>Compactor가 재시작되면 이전에 중단된 지점에서 계속 작업을 수행합니다.</li>
<li>설정된 <code class="language-text">compaction_interval</code>마다 압축과 보존을 적용하기 위해 루프를 실행합니다.</li>
<li>
<p>Compactor의 알고리즘은 다음과 같습니다</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">- 각 테이블을 단일 인덱스 파일로 압축합니다.
- 전체 인덱스를 순회하여 제거해야 할 청크를 식별하고 표시합니다.
- 표시된 청크를 인덱스에서 제거하고 디스크에 있는 파일에 참조를 저장합니다.
- 새로 수정된 인덱스 파일을 업로드합니다.</code></pre></div>
</li>
<li>보존 알고리즘은 인덱스에 적용되며, 청크는 즉시 삭제되지 않고 추후에 비동기적으로 삭제됩니다.</li>
<li>설정된 <code class="language-text">retention_delete_delay</code>가 만료된 후에만 표시된 청크가 삭제됩니다.</li>
<li>Compactor를 사용하여 보존을 적용할 때는 table_manager가 필요하지 않습니다.</li>
</ul>
<p><strong>설정하기</strong> </p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">...</span>
	<span class="token key atrule">loki</span><span class="token punctuation">:</span>
	<span class="token punctuation">...</span>
		<span class="token key atrule">config</span><span class="token punctuation">:</span>
	    <span class="token key atrule">compactor</span><span class="token punctuation">:</span>
	      <span class="token key atrule">shared_store</span><span class="token punctuation">:</span> s3 // store가 설정되어 있어야 함
	      <span class="token key atrule">retention_delete_delay</span><span class="token punctuation">:</span> 72h
	      <span class="token key atrule">retention_enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token punctuation">...</span></code></pre></div>
<h3 id="table_manager-vs-compactor" style="position:relative;"><a href="#table_manager-vs-compactor" aria-label="table_manager vs compactor permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>table_manager VS Compactor</h3>
<p><code class="language-text">table_manager</code>는 데이터의 논리적 구조와 스키마를 관리하고 구성하며, <code class="language-text">Compactor</code>는 저장된 데이터의 물리적인 관리와 최적화를 담당합니다.</p>
<h3 id="결과" style="position:relative;"><a href="#%EA%B2%B0%EA%B3%BC" aria-label="결과 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>결과</h3>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100.60606060606061%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAACeUlEQVR42p1V25KTQBTk///I0ir11dLHXXU1yYZAgHCHGSDc2j6HEFNmfdhNVWeYW9PdcyZx4iSBe/Cwdw/wjwHKqkJV19f2tXAOno+Pnz7j3fsP+PL1mxLd4tWENb9M2xIdasNna64K3wKnsi2q429U3g8UtcVmu0OSpiQ3b7OcFQXc/TP2uw1iEsVJiizPUZTlm6CEaUYCzau6Kvu/rfoGL1g21iIMQzw8PKqycRwV06X99xnjAEwDZm1HfZ6mv2scURSEER4ev8PzjyjLCjlVr7alr88cEwXH3MDPjLa7uMavqEKU5Mi5Ji9oWe1xUxCdaD1DQqxZSiukEsmSbYHnuMQhNfDSGk9hgW1UIIw5xzUy78hbDVVGpxgNy6ftOtimgSEqjg/DoFZqRiPxWFur1XHo0TaGfYL7pnnWtU7FcOvaXIvYGKsHY7lZyBXc0LHtrv0LLn0ZbyhAWrUsGYW0fAxCzfOZ11D6qrjt7tHdQ0QpoSiztrlalZvTnc/aF8KF9BbLOo2FTszqhHNn7lNCIZGOlM92swXmidXQL2B5DH2PnpA1kmcqh8UTFTdxnOiYzCmhSBUVMliyNMKMC6szgrJFVHXYZ1Tfj5jlJdOCmQcgn4S/VJK19NY5rUORLJ2CWbphCq88w80beEWLpxOzGUYlEKIV8gmpUM7gds5ZTrShwgkZrfinjAp7HEkW1R0OObMZJtlyRxjHsVbFHeGicNZqd6NFoRD5JP1JhWL5JYUBM79TqLXHHHoWpYTtholaPWQWPm3vEhKel/s63t5vRhSwzORQhWgdd+RqyRWTayd/B2Gc6FUKiChZINcxfQEnrk0ue1f8AdOC/+YTcT4oAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="s3-index"
        title="s3-index"
        src="/static/aa3e5004042055e0586f22e3a280646e/7c811/s3-index.png"
        srcset="/static/aa3e5004042055e0586f22e3a280646e/103f2/s3-index.png 165w,
/static/aa3e5004042055e0586f22e3a280646e/748ba/s3-index.png 330w,
/static/aa3e5004042055e0586f22e3a280646e/7c811/s3-index.png 660w,
/static/aa3e5004042055e0586f22e3a280646e/d28e0/s3-index.png 990w,
/static/aa3e5004042055e0586f22e3a280646e/42a19/s3-index.png 1024w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 87.27272727272728%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACKklEQVR42pVUa3PTMBDM//89DHQKpZTvwEApMLSBJI5jyy/5JduJH9u7U+wkhJbhw3qls7xa3Z08y4sC1zfvcf3uBp+/3OLFywu8vnqLnw8PEn91cYnLN1dw1muUxiDLc/A3T2HGjzCKECQpVBgiThIExBzjcRTHwqMQ83OYZbSoLAnuDxhTwFMB/CCAqSoRKMpS8JyrM4cBCbj3t8Is5iklL9Mss/iHq1OH9FAkwkfm48mxCHoU+wv0EeujOUMESzrSfD5HHCdomgZt2z6Jrt2hJzAPXSvousN7EcwJHz5+wnLlyC68QcH5K0oaG2E7LqGLClFeISFWqYGblAh1Pq0XQU56GMXwqSB8bD+wVR6rzjFFMeZlmOFeZVhEBb66Gt83Giuf3tH3rLF3SDnTqQR3ZLugfjN1Lblstlv0Qy9V5z7kjujaLdB3qCs7N8TDMKDv+73DfcmZjalQ0cfCJFpTTuuJT1HtYed2jQhy3oIwwsZTAnfjY+W44rxptmdCguYU1oQZHZYS4F3suBZ3guoU9RS3AgxxR2hGhwxesKV83d19w66pQf1AaWqn1hjBrcHp4Razp/Ild/wtY6oyT3iHlbOGlzVYxAYqr4V/RRZeVqPtOhEYAGk3dsYF6br+UJQ40Ui0lkqvNx5WKsZvP8I6SGS8JCz8GA7NdZoJ+DryNQ2pldIsn27L7M/fEbeG4VYw9qdhjsDzvDjc2/GncXaX/w+HzcfYsaFHE3ASQ3r5evYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="s3-index-retention"
        title="s3-index-retention"
        src="/static/df069b0ef5bf0f5b7ed69df1da54127d/7c811/s3-index-retention.png"
        srcset="/static/df069b0ef5bf0f5b7ed69df1da54127d/103f2/s3-index-retention.png 165w,
/static/df069b0ef5bf0f5b7ed69df1da54127d/748ba/s3-index-retention.png 330w,
/static/df069b0ef5bf0f5b7ed69df1da54127d/7c811/s3-index-retention.png 660w,
/static/df069b0ef5bf0f5b7ed69df1da54127d/d28e0/s3-index-retention.png 990w,
/static/df069b0ef5bf0f5b7ed69df1da54127d/b0f6f/s3-index-retention.png 1042w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>위의 사진을 보시면 loki<em>index</em> 형식으로 log index가 쌓이고 있습니다. 해당 데이터들은 설정된 Retention 값에 따라 gz file로 압축하여 AWS S3에 전송한 후 pod내에선 삭제합니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 660px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 23.03030303030303%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAw0lEQVR42qWOSw+CMBCESyFQKQ8FqhIpMdHEs9BCvHnz//+icVuNj3j08GV2J5OdZdebgblYzNZissYzT5PXcTg/GWDGAdaMsOR7fTF8wbabA7ruhF139LTtEWq9R543WK52qOoeTaMhZY0oKhDHK1KJRDRgjBPsG933UEqhKAqUZYmqqqG1piMKQiyQZTl5lc+4WcqMDkbgPKQ9o+Lca5qmVBaDuUEIgSRJXriA47OZc44wDAmOIAi899jfuAz7eflP7lb5d+ZJief8AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="pod-index"
        title="pod-index"
        src="/static/648e42d1f8a629a847d7340822510d72/7c811/loki-pod-index.png"
        srcset="/static/648e42d1f8a629a847d7340822510d72/103f2/loki-pod-index.png 165w,
/static/648e42d1f8a629a847d7340822510d72/748ba/loki-pod-index.png 330w,
/static/648e42d1f8a629a847d7340822510d72/7c811/loki-pod-index.png 660w,
/static/648e42d1f8a629a847d7340822510d72/d28e0/loki-pod-index.png 990w,
/static/648e42d1f8a629a847d7340822510d72/bb51b/loki-pod-index.png 1320w,
/static/648e42d1f8a629a847d7340822510d72/13d1f/loki-pod-index.png 1518w"
        sizes="(max-width: 660px) 100vw, 660px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>실제로 Retention을 24h로 설정한 Loki pod 내부입니다. 총 4일이 지나 loki<em>index</em> 디렉토리가 4개가 생성되어있는데, 가장 최근의 값인 loki<em>index</em>19597에만 log data들이 저장되어 있고 loki<em>index</em>19594의 디렉토리는 비어져있습니다.</p>
<h1 id="마치며" style="position:relative;"><a href="#%EB%A7%88%EC%B9%98%EB%A9%B0" aria-label="마치며 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>마치며</h1>
<p>이렇게 PLG (Prometheus, Loki, Grafana)를 이용하여 모니터링 시스템을 구축해보았습니다! 개인적으로 EFK (Elasticsearch, Fluent-bit, Kibana)보다 가볍지만 강력하다고 생각이 들어요!
다음엔 Grafana Dashboard 설정에 대해 공부해보고 포스팅 해보도록 하겠습니다!</p>
<h1 id="reference" style="position:relative;"><a href="#reference" aria-label="reference permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference</h1>
<p><a href="https://prometheus.io/">Prometheus - Monitoring system &#x26; time series database</a></p>
<p><a href="https://ksr930.tistory.com/315">[Helm] kube-prometheus-stack 모니터링 시스템 구축하기 (Grafana, exporter, monitoring)</a></p>
<p><a href="https://grafana.com/docs/loki/latest/operations/storage/retention/#table-manager">Retention |  Grafana Loki documentation</a></p></div><div class="post-divider border-bottom border-color-light-grey margin-bottom-half margin-top-half"></div><div class="comment-container text-center padding-top"><button class="tags">Load comments</button></div></div></div><div class="sidebar-wrapper padding-top-half padding-bottom-2"><aside class="sidebar-container " style="width:300px"><aside class="latest-posts-container padding-top padding-bottom"><h3 class="text-uppercase"><small>Latest posts</small></h3><div><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half" href="/blog"><span>Blog 이사갔습니다!!! </span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half" href="/cka-ckad-review"><span>CKA, CKAD 취득 후기</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half" href="/k8s-pod-lifecycle"><span>쿠버네티스에서 Pod의 생애주기</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half" href="/2023-review"><span>2023년 회고</span></a></div></aside><aside class="categories-container padding-top padding-bottom"><h3 class="text-uppercase"><small>Categories</small></h3><div><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/devops"><span>Devops</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/kubernetes"><span>kubernetes</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/k8s"><span>k8s</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/certification"><span>Certification</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/pod"><span>Pod</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/review"><span>review</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/kubernetes"><span>Kubernetes</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/promehtues"><span>promehtues</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/loki"><span>loki</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/grafana"><span>grafana</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/observability"><span>Observability</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/aws"><span>AWS</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/aws-eks"><span>AWS EKS</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/aws-ec2"><span>AWS EC2</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/efkstack"><span>EFKStack</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/ec2"><span>EC2</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/argocd"><span>ArgoCD</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/slack"><span>Slack</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/metric"><span>metric</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/storage"><span>Storage</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/linux"><span>Linux</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/ubuntu"><span>Ubuntu</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/config"><span>config</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/git"><span>git</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/java"><span>Java</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/reactjs"><span>React.js</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/database"><span>DataBase</span></a><a class="block border-bottom border-color-light-grey padding-top-half padding-bottom-half category" href="/category/develop"><span>develop</span></a></div></aside><aside class="categories-container padding-top padding-bottom"><h3 class="text-uppercase"><small>Tags</small></h3><div><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/devops"><span class="content">Devops</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/kubernetes"><span class="content">kubernetes</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/k8s"><span class="content">k8s</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/certification"><span class="content">Certification</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/pod"><span class="content">Pod</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/review"><span class="content">review</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/kubernetes"><span class="content">Kubernetes</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/promehtues"><span class="content">promehtues</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/loki"><span class="content">loki</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/grafana"><span class="content">grafana</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/observability"><span class="content">Observability</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/aws"><span class="content">AWS</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/aws-eks"><span class="content">AWS EKS</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/aws-ec2"><span class="content">AWS EC2</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/aws-opensearch"><span class="content">AWS OpenSearch</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/efkstack"><span class="content">EFKStack</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/ec2"><span class="content">EC2</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/argocd"><span class="content">ArgoCD</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/slack"><span class="content">Slack</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/metric"><span class="content">metric</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/k8s"><span class="content">K8s</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/storage"><span class="content">Storage</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/eks"><span class="content">EKS</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/linux"><span class="content">Linux</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/ubuntu"><span class="content">Ubuntu</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/gitlab"><span class="content">Gitlab</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/jenkins"><span class="content">Jenkins</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/config"><span class="content">config</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/terminal"><span class="content">terminal</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/iterms"><span class="content">iterms</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/git"><span class="content">git</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/github"><span class="content">github</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/develop"><span class="content">develop</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/java"><span class="content">Java</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/spring"><span class="content">Spring</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/cron"><span class="content">cron</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/reactjs"><span class="content">React.js</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/reduxjs"><span class="content">Redux.js</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/javascript"><span class="content">Javascript</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/db"><span class="content">DB</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/database"><span class="content">DataBase</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/mysql"><span class="content">MySQL</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/vue"><span class="content">vue</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/spring"><span class="content">spring</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/mysql"><span class="content">mysql</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/jsp"><span class="content">jsp</span></a><a class="inline-block margin-right-half margin-bottom-half  border border-color-light-grey padding-left-half padding-right-half tags" href="/tag/db"><span class="content">db</span></a></div></aside></aside></div></section><footer class="footer-container background-color-dark-grey color-white  text-center padding-top padding-bottom-half"><div class="container"><div class="social-links-container margin-half"><a class="margin-left-half margin-right-half" href="https://github.com/leehosu" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" style="transform-origin:0.484375em 0.5em;color:#FFF"><g transform="translate(248 256)"><g transform="translate(0, 0)  scale(1.125, 1.125)  rotate(0 0 0)"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" transform="translate(-248 -256)"></path></g></g></svg></a><a class="margin-left-half margin-right-half" href="https://leehosu.github.io/rss.xml" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="transform-origin:0.4375em 0.5em;color:#FFF"><g transform="translate(224 256)"><g transform="translate(0, 0)  scale(1.125, 1.125)  rotate(0 0 0)"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8 0 416 186.2 416 416c0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96C14.3 96 0 81.7 0 64zM0 416a64 64 0 1 1 128 0A64 64 0 1 1 0 416zM32 160c159.1 0 288 128.9 288 288c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224c-17.7 0-32-14.3-32-32s14.3-32 32-32z" transform="translate(-224 -256)"></path></g></g></svg></a></div><div class="footer-links-container margin-half"><a class="item margin-left-half margin-right-half color-white inline-block" href="/">Home</a><a class="item margin-left-half margin-right-half color-white inline-block" href="/about">About</a><a class="item margin-left-half margin-right-half color-white inline-block" href="https://leehosu.github.io/sitemap.xml" target="_blank" rel="noopener noreferrer">Sitemap</a></div><div class="copyright-container margin-half color-grey"><small>Copyright © 2021 leehosu. Unless otherwise noted, all code MIT license.</small></div></div></footer><div class="scroll-to-top position-fixed background-color-grey-half 
          cursor-pointer transition padding line-height-reset border-radius"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="angle-up" class="svg-inline--fa fa-angle-up " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="color:#FFF"><path fill="currentColor" d="M201.4 137.4c12.5-12.5 32.8-12.5 45.3 0l160 160c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L224 205.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l160-160z"></path></svg></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'G-2ZF5F3414R', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/kube-prometheus-stack";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-d44c6eeb449e05cd8822.js"],"app":["/app-be6aa568186f41ee1ded.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-4fd24115ca599e07e745.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-cf9efdd8ba5d4febd4b2.js"],"component---src-pages-index-jsx":["/component---src-pages-index-jsx-6df7b5104694cbef1f37.js"],"component---src-templates-category-template-jsx":["/component---src-templates-category-template-jsx-d25558fab5ba1dd54b60.js"],"component---src-templates-page-template-jsx":["/component---src-templates-page-template-jsx-aa60139dda3dd02aded8.js"],"component---src-templates-post-template-jsx":["/component---src-templates-post-template-jsx-82e87410d84186ad00a8.js"],"component---src-templates-tag-template-jsx":["/component---src-templates-tag-template-jsx-450aa0a8c865610bfece.js"]};/*]]>*/</script><script src="/polyfill-d44c6eeb449e05cd8822.js" nomodule=""></script><script src="/component---src-templates-post-template-jsx-82e87410d84186ad00a8.js" async=""></script><script src="/e5ddc9d07ff53122a1bea9b3e73594ce6812cb5e-adfef642974b334bc570.js" async=""></script><script src="/2cca2479-00397cf64e0564764281.js" async=""></script><script src="/c16184b3-4d7cb95e09fa792a5d07.js" async=""></script><script src="/5a689306-b93556dcf695fd8d45c7.js" async=""></script><script src="/framework-81481035b2cfdfa9d9ed.js" async=""></script><script src="/styles-d92458a40376ac1079c2.js" async=""></script><script src="/app-be6aa568186f41ee1ded.js" async=""></script><script src="/webpack-runtime-398e8795e5531745fb6f.js" async=""></script></body></html>